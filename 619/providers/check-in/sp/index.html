<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.104.3"><link rel=alternate type=application/rss+xml href=../../../providers/check-in/sp/index.xml><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel="shortcut icon" href=../../../favicons/favicon.ico><link rel=apple-touch-icon href=../../../favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=../../../favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=../../../favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=../../../favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=../../../favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=../../../favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=../../../favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=../../../favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=../../../favicons/android-192x192.png sizes=192x192><title>Service Providers | Documentation</title><meta name=description content="EGI documentation"><meta property="og:title" content="Service Providers"><meta property="og:description" content="Check-in guide for Service Providers"><meta property="og:type" content="website"><meta property="og:url" content="/providers/check-in/sp/"><meta property="og:site_name" content="Documentation"><meta itemprop=name content="Service Providers"><meta itemprop=description content="Check-in guide for Service Providers"><meta name=twitter:card content="summary"><meta name=twitter:title content="Service Providers"><meta name=twitter:description content="Check-in guide for Service Providers"><link rel=preload href=../../../scss/main.min.cf17fb22ec677b25d6e0b252db304a8d9ddd90de85adc30494f93f5196259e54.css as=style><link href=../../../scss/main.min.cf17fb22ec677b25d6e0b252db304a8d9ddd90de85adc30494f93f5196259e54.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
<script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script>
<link rel=stylesheet href=../../../css/prism.css><link rel=stylesheet href=../../../css/shortcodes/tabbed-panex.css><link rel=stylesheet href=../../../css/tags.css><link rel=stylesheet href=../../../css/egi.css><script type=text/javascript src=../../../js/prism.js></script>
<script type=text/javascript src=../../../js/featherlight.min.js></script>
<script type=text/javascript src=../../../js/highlight.min.js></script>
<script type=text/javascript src=../../../js/egi.js></script>
<script type=text/javascript src=../../../js/github.min.js></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=../../../><span class=navbar-logo><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 250 189.57"><defs><style>.cls-1{fill:#fff}</style></defs><path class="cls-1" d="M131.12 9.02c.7-5.22 5.16-9.02 10.29-9.02h0c.46.0.93.03 1.39.09h0c5.69.76 9.69 5.99 8.93 11.68h0c-.76 5.69-6 9.69-11.68 8.93h0c-5.69-.76-9.69-5.99-8.94-11.68h0z"/><path class="cls-1" d="M105.69.45c.53-.08 1.06-.12 1.59-.12h0c5.04.0 9.47 3.68 10.26 8.82h0c.87 5.68-3.02 10.98-8.7 11.85h0c-5.67.87-10.98-3.02-11.85-8.7h0c-.87-5.67 3.03-10.98 8.7-11.85h0z"/><path class="cls-1" d="M70.14 11.32c1.43-.67 2.94-1 4.43-1h0c3.9.0 7.63 2.2 9.4 5.96h0c2.45 5.19.24 11.39-4.96 13.84h0c-5.19 2.45-11.39.24-13.84-4.96h0c-2.45-5.19-.23-11.39 4.96-13.84h0z"/><path class="cls-1" d="M195.27 31.3c2.05-2.4 4.96-3.63 7.89-3.63h0c2.4.0 4.8.83 6.77 2.51h0c4.34 3.74 4.86 10.3 1.11 14.65h0c-3.74 4.36-10.3 4.86-14.66 1.12h0c-4.36-3.74-4.86-10.3-1.12-14.66h0z"/><path class="cls-1" d="M39.16 31.84c1.98-1.76 4.45-2.64 6.92-2.64h0c2.86.0 5.71 1.17 7.76 3.48h0c3.82 4.28 3.45 10.86-.83 14.68h0c-4.28 3.82-10.85 3.45-14.67-.84h0c-3.82-4.28-3.45-10.85.83-14.68h0z"/><path class="cls-1" d="M220 55.07c1.75-1.13 3.71-1.68 5.65-1.68h0c3.41.0 6.74 1.67 8.73 4.74h0c3.11 4.82 1.75 11.25-3.07 14.38h0c-4.82 3.12-11.25 1.75-14.38-3.06h0c-3.11-4.82-1.75-11.25 3.07-14.38h0z"/><path class="cls-1" d="M15.25 60.26c1.97-3.17 5.37-4.91 8.84-4.91h0c1.87.0 3.77.51 5.48 1.57h0c4.87 3.03 6.37 9.44 3.34 14.31h0c-3.03 4.88-9.44 6.37-14.31 3.34h0c-4.88-3.03-6.37-9.44-3.34-14.32h0z"/><path class="cls-1" d="M.37 94.32c1.26-4.62 5.45-7.65 10.02-7.65h0c.91.0 1.83.12 2.75.37h0c5.54 1.52 8.79 7.24 7.28 12.78h0c-1.52 5.53-7.23 8.79-12.77 7.27h0c-5.54-1.52-8.8-7.23-7.28-12.77H.37z"/><path class="cls-1" d="M129.49 30.75c.5-3.7 3.67-6.39 7.29-6.39h0c.33.0.65.02.99.06h0c4.03.54 6.86 4.25 6.32 8.28h0c-.54 4.03-4.24 6.86-8.27 6.33h0c-4.04-.54-6.88-4.25-6.34-8.28h0z"/><path class="cls-1" d="M111.45 24.67c.38-.06.75-.08 1.12-.08h0c3.58.0 6.71 2.61 7.27 6.25h0c.62 4.02-2.14 7.78-6.17 8.4h0c-4.02.62-7.78-2.15-8.4-6.17h0c-.62-4.02 2.15-7.78 6.17-8.4h0z"/><path class="cls-1" d="M153.37 35.33c1.22-2.73 3.92-4.35 6.73-4.35h0c1.01.0 2.03.21 3.01.65h0c3.71 1.67 5.37 6.03 3.7 9.74h0c-1.66 3.71-6.02 5.37-9.74 3.7h0c-3.71-1.66-5.37-6.02-3.7-9.74h0z"/><path class="cls-1" d="M86.26 32.37c1.01-.47 2.09-.7 3.14-.7h0c2.76.0 5.41 1.56 6.67 4.22h0c1.74 3.68.16 8.07-3.52 9.81h0c-3.68 1.74-8.07.17-9.81-3.51h0c-1.74-3.68-.16-8.07 3.52-9.81h0z"/><path class="cls-1" d="M174.95 46.54c1.45-1.7 3.51-2.57 5.58-2.57h0c1.7.0 3.41.58 4.8 1.78h0c3.09 2.65 3.44 7.3.79 10.39h0c-2.65 3.09-7.3 3.44-10.39.79h0c-3.09-2.65-3.44-7.3-.79-10.39h0z"/><path class="cls-1" d="M64.3 46.92c1.41-1.25 3.16-1.87 4.9-1.87h0c2.03.0 4.04.83 5.5 2.46h0c2.71 3.04 2.44 7.69-.59 10.4h0c-3.04 2.71-7.69 2.44-10.4-.59h0c-2.71-3.04-2.44-7.69.59-10.41h0z"/><path class="cls-1" d="M192.48 63.39c1.24-.8 2.63-1.19 4.01-1.19h0c2.41.0 4.77 1.18 6.18 3.36h0c2.21 3.41 1.24 7.98-2.17 10.19h0c-3.41 2.22-7.98 1.24-10.19-2.17h0c-2.21-3.41-1.24-7.98 2.17-10.19h0z"/><path class="cls-1" d="M47.35 67.06c1.4-2.24 3.8-3.48 6.27-3.48h0c1.33.0 2.67.36 3.88 1.11h0c3.46 2.15 4.52 6.7 2.37 10.15h0c-2.15 3.45-6.69 4.51-10.15 2.36h0c-3.46-2.15-4.51-6.69-2.37-10.15h0z"/><path class="cls-1" d="M36.81 91.21c.89-3.27 3.87-5.43 7.1-5.43h0c.65.0 1.3.09 1.95.26h0c3.92 1.08 6.24 5.13 5.16 9.06h0c-1.07 3.92-5.13 6.23-9.05 5.15h0c-3.92-1.07-6.23-5.12-5.16-9.04h0z"/><path class="cls-1" d="M128.15 48.47c.34-2.47 2.44-4.26 4.87-4.26h0c.22.0.44.01.66.05h0c2.69.36 4.58 2.83 4.21 5.52h0c-.35 2.69-2.83 4.58-5.52 4.22h0c-2.69-.36-4.57-2.83-4.22-5.52h0z"/><path class="cls-1" d="M116.13 44.42c.25-.04.5-.05.75-.05h0c2.39.0 4.48 1.74 4.85 4.17h0c.41 2.68-1.43 5.19-4.11 5.6h0c-2.68.41-5.19-1.43-5.6-4.11h0c-.41-2.68 1.43-5.19 4.11-5.6h0z"/><path class="cls-1" d="M144.08 51.53c.82-1.82 2.61-2.9 4.49-2.9h0c.67.0 1.36.14 2.01.44h0 0c2.48 1.11 3.58 4.01 2.47 6.49h0c-1.12 2.47-4.02 3.58-6.5 2.47h0c-2.48-1.11-3.58-4.02-2.47-6.49h0z"/><path class="cls-1" d="M99.33 49.56c.68-.32 1.39-.47 2.09-.47h0c1.84.0 3.6 1.04 4.44 2.82h0c1.16 2.45.11 5.38-2.34 6.54h0c-2.45 1.16-5.38.11-6.54-2.34h0c-1.16-2.46-.11-5.38 2.35-6.54h0z"/><path class="cls-1" d="M84.7 59.25c.94-.83 2.1-1.25 3.27-1.25h0c1.35.0 2.7.56 3.67 1.64h0c1.8 2.02 1.63 5.13-.4 6.93h0c-2.02 1.81-5.13 1.63-6.93-.39h0c-1.81-2.02-1.63-5.13.39-6.94h0z"/><path class="cls-1" d="M170.15 70.24c.82-.53 1.75-.79 2.67-.79h0c1.61.0 3.18.79 4.13 2.24h0c1.47 2.28.83 5.32-1.45 6.8h0c-2.27 1.48-5.32.82-6.8-1.45h0c-1.47-2.28-.82-5.32 1.45-6.79h0z"/><path class="cls-1" d="M178.2 84.32c.46-.14.93-.2 1.4-.2h0c2.11.0 4.07 1.38 4.7 3.53h0c.77 2.6-.72 5.33-3.33 6.1h0c-2.6.77-5.33-.72-6.1-3.32h0c-.77-2.6.72-5.33 3.33-6.1h0z"/><path class="cls-1" d="M66.36 88.78c.6-2.18 2.58-3.62 4.74-3.62h0c.43.0.87.06 1.3.18h0c2.62.72 4.16 3.42 3.44 6.03h0c-.71 2.62-3.42 4.16-6.03 3.44h0c-2.62-.72-4.16-3.42-3.44-6.03h0z"/><path class="cls-1" d="M127.18 61.35c.21-1.57 1.56-2.71 3.1-2.71h0c.13.0.27.0.42.03h0c1.71.23 2.9 1.8 2.69 3.51h0c-.23 1.71-1.81 2.91-3.52 2.68h0c-1.71-.23-2.91-1.8-2.69-3.51h0z"/><path class="cls-1" d="M119.54 58.77c.16-.02.32-.04.48-.04h0c1.51.0 2.84 1.11 3.08 2.65h0c.26 1.7-.91 3.3-2.61 3.56h0c-1.71.26-3.3-.91-3.56-2.62h0c-.26-1.7.91-3.3 2.61-3.56h0z"/><path class="cls-1" d="M137.31 63.29c.52-1.16 1.65-1.84 2.85-1.84h0c.43.0.87.09 1.29.28h0c1.57.7 2.27 2.55 1.57 4.13h0c-.71 1.57-2.56 2.28-4.13 1.57h0c-1.57-.71-2.27-2.55-1.57-4.13h0z"/><path class="cls-1" d="M99.54 68.21c.59-.53 1.34-.8 2.08-.8h0c.86.0 1.72.35 2.33 1.05h0c1.15 1.29 1.04 3.26-.25 4.41h0c-1.28 1.15-3.26 1.03-4.41-.25h0c-1.14-1.29-1.04-3.26.25-4.41h0z"/><path class="cls-1" d="M153.9 75.19c.52-.34 1.11-.5 1.69-.5h0c1.03.0 2.03.5 2.62 1.42h0c.94 1.45.53 3.39-.92 4.32h0c-1.45.94-3.38.53-4.32-.92h0c-.94-1.45-.52-3.38.92-4.32h0z"/><path class="cls-1" d="M92.36 76.74c.59-.95 1.61-1.47 2.66-1.48h0c.56.0 1.13.16 1.65.47h0c1.47.92 1.91 2.84 1 4.3h0c-.91 1.47-2.84 1.92-4.3 1.01h0c-1.46-.92-1.91-2.84-1-4.31h0z"/><path class="cls-1" d="M159.01 84.15c.3-.09.59-.13.89-.13h0c1.35.0 2.6.88 2.99 2.24h0c.49 1.66-.46 3.39-2.1 3.88h0c-1.66.49-3.39-.46-3.88-2.11h0c-.49-1.66.46-3.39 2.11-3.88h0z"/><path class="cls-1" d="M87.89 86.98c.38-1.39 1.64-2.3 3.01-2.3h0c.27.0.55.04.82.11h0c1.67.46 2.65 2.18 2.19 3.84h0c-.46 1.66-2.18 2.64-3.84 2.19h0c-1.67-.46-2.64-2.18-2.19-3.84h0z"/><path class="cls-1" d="M204.54 84.51c.69-.21 1.39-.31 2.08-.31h0c3.18.0 6.12 2.08 7.06 5.29h0c1.16 3.9-1.08 8-4.98 9.15h0c-3.91 1.14-8-1.08-9.16-4.98h0c-1.14-3.9 1.08-8 4.99-9.15h0z"/><rect class="cls-1" x="232.02" y="120.84" width="17.18" height="68.73"/><path class="cls-1" d="M24.1 155.2c0-4.74 3.85-8.59 8.6-8.59h51.98c1.21.0 2.23-.47 3.04-1.26h0c.79-.8 1.25-1.83 1.25-3.04h0c0-1.22-.47-2.23-1.25-3.04h0c-.81-.79-1.83-1.25-3.04-1.26H34.41c-4.75.0-8.98 1.91-12.11 5.02h0c-3.12 3.14-5.02 7.39-5.03 12.16h0c.01 4.78 1.91 9.02 5.03 12.16h0c3.12 3.13 7.35 5.02 12.11 5.02H106.2v17.19H34.39c-9.45.0-18.08-3.87-24.26-10.08h0C3.94 173.3.08 164.66.09 155.2h0c0-9.46 3.85-18.1 10.04-24.29h0c6.18-6.21 14.82-10.07 24.27-10.07h50.27c5.9.0 11.33 2.41 15.19 6.28h0c3.88 3.86 6.3 9.29 6.29 15.19h0c0 5.91-2.42 11.33-6.29 15.2h0c-3.85 3.86-9.27 6.28-15.17 6.28h-52c-4.75.0-8.6-3.84-8.6-8.59z"/><path class="cls-1" d="M139.47 155.2c0 4.75 3.84 8.59 8.59 8.59h51.97c1.21.0 2.24.47 3.04 1.26h0c.79.81 1.25 1.83 1.25 3.04h0c0 1.21-.47 2.23-1.25 3.03h0c-.8.79-1.83 1.25-3.04 1.26h-50.26c-4.76.0-8.98-1.89-12.11-5.02h0c-3.11-3.14-5.02-7.37-5.02-12.16h0c0-4.77 1.91-9.02 5.02-12.16h0c3.13-3.11 7.35-5.02 12.11-5.02h71.79v-17.18h-71.8c-9.45.0-18.08 3.86-24.25 10.07h0c-6.2 6.19-10.05 14.83-10.05 24.29h0c0 9.46 3.84 18.1 10.05 24.29h0c6.18 6.21 14.81 10.08 24.27 10.08h50.26c5.91.0 11.34-2.42 15.2-6.3h0c3.86-3.86 6.29-9.28 6.28-15.19h0c0-5.9-2.42-11.32-6.28-15.19h0c-3.86-3.87-9.28-6.29-15.18-6.29h-51.99c-4.75.0-8.59 3.85-8.59 8.59h0z"/><path class="cls-1" d="M250 93.22c0 5.74-4.66 10.4-10.41 10.4s-10.39-4.66-10.39-10.4 4.66-10.4 10.39-10.4S250 87.48 250 93.22z"/><path class="cls-1" d="M184.69 19.75c0 5.74-4.65 10.4-10.4 10.4s-10.39-4.66-10.39-10.4 4.65-10.4 10.39-10.4 10.4 4.66 10.4 10.4z"/><path class="cls-1" d="M167.09 62.2c0 2.71-2.2 4.91-4.91 4.91s-4.9-2.2-4.9-4.91 2.19-4.91 4.9-4.91 4.91 2.2 4.91 4.91z"/><path class="cls-1" d="M82.47 75.28c0 2.71-2.2 4.91-4.91 4.91s-4.9-2.2-4.9-4.91 2.19-4.9 4.9-4.9 4.91 2.19 4.91 4.9z"/><circle class="cls-1" cx="148.83" cy="70.08" r="3.13"/><path class="cls-1" d="M113.31 64.86c0 1.73-1.4 3.13-3.13 3.13s-3.12-1.4-3.12-3.13 1.4-3.12 3.12-3.12 3.13 1.4 3.13 3.12z"/></svg></span><span class=font-weight-bold>Documentation</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-2 mb-2 mb-lg-0"><a class=nav-link href=../../../users/><i class='fa fa-user-friends'></i><span>For Users</span></a></li><li class="nav-item mr-2 mb-2 mb-lg-0"><a class="nav-link active" href=../../../providers/><i class='fa fa-users-cog'></i><span class=active>For Providers</span></a></li><li class="nav-item mr-2 mb-2 mb-lg-0"><a class=nav-link href=../../../internal/><i class='fa fa-cogs'></i><span>Internal Services</span></a></li><li class="nav-item mr-2 mb-2 mb-lg-0"><a class=nav-link href=../../../support/><i class='fa fa-lightbulb'></i><span>Support</span></a></li><li class="nav-item mr-2 mb-2 mb-lg-0"><a class=nav-link href=../../../about/><i class='fa fa-info'></i><span>About</span></a></li></ul></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><script>$(function(){$("#td-section-nav a").removeClass("active"),$("#td-section-nav #m-providerscheck-insp").addClass("active"),$("#td-section-nav #m-providerscheck-insp-li span").addClass("td-sidebar-nav-active-item"),$("#td-section-nav #m-providerscheck-insp").parents("li").addClass("active-path"),$("#td-section-nav li.active-path").addClass("show"),$("#td-section-nav li.active-path").children("input").prop("checked",!0),$("#td-section-nav #m-providerscheck-insp-li").siblings("li").addClass("show"),$("#td-section-nav #m-providerscheck-insp-li").children("ul").children("li").addClass("show"),$("#td-sidebar-menu").toggleClass("d-none")})</script><div id=td-sidebar-menu class="td-sidebar__inner d-none"><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search…" aria-label=Search… autocomplete=off data-offline-search-index-json-src=../../../offline-search-index.b0d43dee988d0bd5d06a9ba66cf1b59c.json data-offline-search-base-href=../../../ data-offline-search-max-results=10>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav foldable-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-providers-li><a href=../../../providers/ title="Service Provider Guides" class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-providers><span>For Providers</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-providersjoining-li><input type=checkbox id=m-providersjoining-check>
<label for=m-providersjoining-check><a href=../../../providers/joining/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersjoining><span>Joining EGI as a provider</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersjoiningfederated-resource-centre-li><input type=checkbox id=m-providersjoiningfederated-resource-centre-check>
<label for=m-providersjoiningfederated-resource-centre-check><a href=../../../providers/joining/federated-resource-centre/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersjoiningfederated-resource-centre><span>Joining as a Federated Resource Centre</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersjoiningtechnology-provider-li><input type=checkbox id=m-providersjoiningtechnology-provider-check>
<label for=m-providersjoiningtechnology-provider-check><a href=../../../providers/joining/technology-provider/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersjoiningtechnology-provider><span>Joining as a Technology Provider</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersjoiningnew-provider-li><input type=checkbox id=m-providersjoiningnew-provider-check>
<label for=m-providersjoiningnew-provider-check><a href=../../../providers/joining/new-provider/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersjoiningnew-provider><span>Joining as a provider for existing EGI services</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersjoiningcore-service-li><input type=checkbox id=m-providersjoiningcore-service-check>
<label for=m-providersjoiningcore-service-check><a href=../../../providers/joining/core-service/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersjoiningcore-service><span>Joining as a provider of a Core Service</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersjoiningnew-service-li><input type=checkbox id=m-providersjoiningnew-service-check>
<label for=m-providersjoiningnew-service-check><a href=../../../providers/joining/new-service/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersjoiningnew-service><span>Introducing a new EGI service</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-providerscheck-in-li><input type=checkbox id=m-providerscheck-in-check>
<label for=m-providerscheck-in-check><a href=../../../providers/check-in/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providerscheck-in><span>Check-in</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providerscheck-inidp-li><input type=checkbox id=m-providerscheck-inidp-check>
<label for=m-providerscheck-inidp-check><a href=../../../providers/check-in/idp/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providerscheck-inidp><span>Identity Providers</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providerscheck-insp-li><input type=checkbox id=m-providerscheck-insp-check>
<label for=m-providerscheck-insp-check><a href=../../../providers/check-in/sp/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providerscheck-insp><span>Service Providers</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-providerscloud-compute-li><input type=checkbox id=m-providerscloud-compute-check>
<label for=m-providerscloud-compute-check><a href=../../../providers/cloud-compute/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providerscloud-compute><span>Cloud Compute</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providerscloud-computerequirements-li><input type=checkbox id=m-providerscloud-computerequirements-check>
<label for=m-providerscloud-computerequirements-check><a href=../../../providers/cloud-compute/requirements/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providerscloud-computerequirements><span>Requirements</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-providerscloud-computeopenstack-li><input type=checkbox id=m-providerscloud-computeopenstack-check>
<label for=m-providerscloud-computeopenstack-check><a href=../../../providers/cloud-compute/openstack/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providerscloud-computeopenstack><span>OpenStack</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providerscloud-computeopenstackaai-li><input type=checkbox id=m-providerscloud-computeopenstackaai-check>
<label for=m-providerscloud-computeopenstackaai-check><a href=../../../providers/cloud-compute/openstack/aai/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-providerscloud-computeopenstackaai><span>Check-in</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providerscloud-computeopenstackaccounting-li><input type=checkbox id=m-providerscloud-computeopenstackaccounting-check>
<label for=m-providerscloud-computeopenstackaccounting-check><a href=../../../providers/cloud-compute/openstack/accounting/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-providerscloud-computeopenstackaccounting><span>Accounting</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providerscloud-computeopenstackcloud-info-li><input type=checkbox id=m-providerscloud-computeopenstackcloud-info-check>
<label for=m-providerscloud-computeopenstackcloud-info-check><a href=../../../providers/cloud-compute/openstack/cloud-info/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-providerscloud-computeopenstackcloud-info><span>Information System</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providerscloud-computeopenstackcloudkeeper-li><input type=checkbox id=m-providerscloud-computeopenstackcloudkeeper-check>
<label for=m-providerscloud-computeopenstackcloudkeeper-check><a href=../../../providers/cloud-compute/openstack/cloudkeeper/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-providerscloud-computeopenstackcloudkeeper><span>VM Image synchronisation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providerscloud-computeopenstackgpu-li><input type=checkbox id=m-providerscloud-computeopenstackgpu-check>
<label for=m-providerscloud-computeopenstackgpu-check><a href=../../../providers/cloud-compute/openstack/gpu/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-providerscloud-computeopenstackgpu><span>GPU flavours</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providerscloud-computeopenstackvo_config-li><input type=checkbox id=m-providerscloud-computeopenstackvo_config-check>
<label for=m-providerscloud-computeopenstackvo_config-check><a href=../../../providers/cloud-compute/openstack/vo_config/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-providerscloud-computeopenstackvo_config><span>VO Configuration guide</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providerscloud-computeregistration-li><input type=checkbox id=m-providerscloud-computeregistration-check>
<label for=m-providerscloud-computeregistration-check><a href=../../../providers/cloud-compute/registration/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providerscloud-computeregistration><span>GOCDB Registration</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providerscloud-computevalidation-li><input type=checkbox id=m-providerscloud-computevalidation-check>
<label for=m-providerscloud-computevalidation-check><a href=../../../providers/cloud-compute/validation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providerscloud-computevalidation><span>Installation Validation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providerscloud-computefaq-li><input type=checkbox id=m-providerscloud-computefaq-check>
<label for=m-providerscloud-computefaq-check><a href=../../../providers/cloud-compute/faq/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providerscloud-computefaq><span>FAQ</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-providersnotebooks-li><input type=checkbox id=m-providersnotebooks-check>
<label for=m-providersnotebooks-check><a href=../../../providers/notebooks/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersnotebooks><span>Notebooks</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersnotebooksarchitecture-li><input type=checkbox id=m-providersnotebooksarchitecture-check>
<label for=m-providersnotebooksarchitecture-check><a href=../../../providers/notebooks/architecture/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersnotebooksarchitecture><span>Architecture</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersnotebooksoperations-li><input type=checkbox id=m-providersnotebooksoperations-check>
<label for=m-providersnotebooksoperations-check><a href=../../../providers/notebooks/operations/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersnotebooksoperations><span>Service Operations</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-providershigh-throughput-compute-li><input type=checkbox id=m-providershigh-throughput-compute-check>
<label for=m-providershigh-throughput-compute-check><a href=../../../providers/high-throughput-compute/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providershigh-throughput-compute><span>High-Throughput Compute</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providershigh-throughput-computehtcondor-ce-accounting-li><input type=checkbox id=m-providershigh-throughput-computehtcondor-ce-accounting-check>
<label for=m-providershigh-throughput-computehtcondor-ce-accounting-check><a href=../../../providers/high-throughput-compute/htcondor-ce-accounting/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providershigh-throughput-computehtcondor-ce-accounting><span>HTCondor-CE Accounting</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providershigh-throughput-computestorage-accounting-li><input type=checkbox id=m-providershigh-throughput-computestorage-accounting-check>
<label for=m-providershigh-throughput-computestorage-accounting-check><a href=../../../providers/high-throughput-compute/storage-accounting/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providershigh-throughput-computestorage-accounting><span>Storage accounting</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providershigh-throughput-computechanging-site-bdii-li><input type=checkbox id=m-providershigh-throughput-computechanging-site-bdii-check>
<label for=m-providershigh-throughput-computechanging-site-bdii-check><a href=../../../providers/high-throughput-compute/changing-site-bdii/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providershigh-throughput-computechanging-site-bdii><span>Changing the Site BDII</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-providersdatahub-li><input type=checkbox id=m-providersdatahub-check>
<label for=m-providersdatahub-check><a href=../../../providers/datahub/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersdatahub><span>DataHub</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersdatahuboneprovider-li><input type=checkbox id=m-providersdatahuboneprovider-check>
<label for=m-providersdatahuboneprovider-check><a href=../../../providers/datahub/oneprovider/ title="DataHub OneProvider" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersdatahuboneprovider><span>OneProvider</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-providersonline-storage-li><input type=checkbox id=m-providersonline-storage-check>
<label for=m-providersonline-storage-check><a href=../../../providers/online-storage/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersonline-storage><span>Online Storage</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersonline-storageminio-oidc-li><input type=checkbox id=m-providersonline-storageminio-oidc-check>
<label for=m-providersonline-storageminio-oidc-check><a href=../../../providers/online-storage/minio-oidc/ title="Access MinIO with EGI Check-in Virtual Organisations" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersonline-storageminio-oidc><span>MinIO and Check-in</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-providersoperations-manuals-li><input type=checkbox id=m-providersoperations-manuals-check>
<label for=m-providersoperations-manuals-check><a href=../../../providers/operations-manuals/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersoperations-manuals><span>Operations manuals and How-Tos</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersoperations-manualsoperations-start-guide-li><input type=checkbox id=m-providersoperations-manualsoperations-start-guide-check>
<label for=m-providersoperations-manualsoperations-start-guide-check><a href=../../../providers/operations-manuals/operations-start-guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersoperations-manualsoperations-start-guide><span>Operations Start Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersoperations-manualsintegration-checklist-li><input type=checkbox id=m-providersoperations-manualsintegration-checklist-check>
<label for=m-providersoperations-manualsintegration-checklist-check><a href=../../../providers/operations-manuals/integration-checklist/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersoperations-manualsintegration-checklist><span>Resource Centre Integration Check List</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersoperations-manualsman01_how_to_publish_site_information-li><input type=checkbox id=m-providersoperations-manualsman01_how_to_publish_site_information-check>
<label for=m-providersoperations-manualsman01_how_to_publish_site_information-check><a href=../../../providers/operations-manuals/man01_how_to_publish_site_information/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersoperations-manualsman01_how_to_publish_site_information><span>MAN01 How to publish site information</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersoperations-manualsman02_service_intervention_management-li><input type=checkbox id=m-providersoperations-manualsman02_service_intervention_management-check>
<label for=m-providersoperations-manualsman02_service_intervention_management-check><a href=../../../providers/operations-manuals/man02_service_intervention_management/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersoperations-manualsman02_service_intervention_management><span>MAN02 Service intervention management</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersoperations-manualsman04_tool_intervention_management-li><input type=checkbox id=m-providersoperations-manualsman04_tool_intervention_management-check>
<label for=m-providersoperations-manualsman04_tool_intervention_management-check><a href=../../../providers/operations-manuals/man04_tool_intervention_management/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersoperations-manualsman04_tool_intervention_management><span>MAN04 Tool Intervention Management</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersoperations-manualsman05_top_and_site_bdii_high_availability-li><input type=checkbox id=m-providersoperations-manualsman05_top_and_site_bdii_high_availability-check>
<label for=m-providersoperations-manualsman05_top_and_site_bdii_high_availability-check><a href=../../../providers/operations-manuals/man05_top_and_site_bdii_high_availability/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersoperations-manualsman05_top_and_site_bdii_high_availability><span>MAN05 top and site BDII High Availability</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersoperations-manualsman06_failover_for_mysql_grid_based_services-li><input type=checkbox id=m-providersoperations-manualsman06_failover_for_mysql_grid_based_services-check>
<label for=m-providersoperations-manualsman06_failover_for_mysql_grid_based_services-check><a href=../../../providers/operations-manuals/man06_failover_for_mysql_grid_based_services/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersoperations-manualsman06_failover_for_mysql_grid_based_services><span>MAN06 Failover for MySQL grid-based services</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersoperations-manualsman07_voms_replication-li><input type=checkbox id=m-providersoperations-manualsman07_voms_replication-check>
<label for=m-providersoperations-manualsman07_voms_replication-check><a href=../../../providers/operations-manuals/man07_voms_replication/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersoperations-manualsman07_voms_replication><span>MAN07 VOMS Replication</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersoperations-manualsman09_accounting_data_publishing-li><input type=checkbox id=m-providersoperations-manualsman09_accounting_data_publishing-check>
<label for=m-providersoperations-manualsman09_accounting_data_publishing-check><a href=../../../providers/operations-manuals/man09_accounting_data_publishing/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersoperations-manualsman09_accounting_data_publishing><span>MAN09 Accounting data publishing</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersoperations-manualshowto01_using_igtf_ca_distribution-li><input type=checkbox id=m-providersoperations-manualshowto01_using_igtf_ca_distribution-check>
<label for=m-providersoperations-manualshowto01_using_igtf_ca_distribution-check><a href=../../../providers/operations-manuals/howto01_using_igtf_ca_distribution/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersoperations-manualshowto01_using_igtf_ca_distribution><span>HOWTO01 Using IGTF CA distribution</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersoperations-manualshowto02_site_certification_required_documentation-li><input type=checkbox id=m-providersoperations-manualshowto02_site_certification_required_documentation-check>
<label for=m-providersoperations-manualshowto02_site_certification_required_documentation-check><a href=../../../providers/operations-manuals/howto02_site_certification_required_documentation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersoperations-manualshowto02_site_certification_required_documentation><span>HOWTO02 Site Certification Required Documentation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersoperations-manualshowto03_site_certification_giis_check-li><input type=checkbox id=m-providersoperations-manualshowto03_site_certification_giis_check-check>
<label for=m-providersoperations-manualshowto03_site_certification_giis_check-check><a href=../../../providers/operations-manuals/howto03_site_certification_giis_check/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersoperations-manualshowto03_site_certification_giis_check><span>HOWTO03 Site Certification GIIS Check</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersoperations-manualshowto04_site_certification_manual_tests-li><input type=checkbox id=m-providersoperations-manualshowto04_site_certification_manual_tests-check>
<label for=m-providersoperations-manualshowto04_site_certification_manual_tests-check><a href=../../../providers/operations-manuals/howto04_site_certification_manual_tests/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersoperations-manualshowto04_site_certification_manual_tests><span>HOWTO04 Site Certification Manual tests</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersoperations-manualsfaq-hepspec06-li><input type=checkbox id=m-providersoperations-manualsfaq-hepspec06-check>
<label for=m-providersoperations-manualsfaq-hepspec06-check><a href=../../../providers/operations-manuals/faq-hepspec06/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersoperations-manualsfaq-hepspec06><span>FAQ HEP SPEC 06</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-providersrod-li><input type=checkbox id=m-providersrod-check>
<label for=m-providersrod-check><a href=../../../providers/rod/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersrod><span>Regional Operator on Duty (ROD)</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersrodoverview-li><input type=checkbox id=m-providersrodoverview-check>
<label for=m-providersrodoverview-check><a href=../../../providers/rod/overview/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersrodoverview><span>Overview</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersrodduties-li><input type=checkbox id=m-providersrodduties-check>
<label for=m-providersrodduties-check><a href=../../../providers/rod/duties/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersrodduties><span>Duties</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersrodcommunication-li><input type=checkbox id=m-providersrodcommunication-check>
<label for=m-providersrodcommunication-check><a href=../../../providers/rod/communication/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersrodcommunication><span>Communication channels</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersrodsecurity-li><input type=checkbox id=m-providersrodsecurity-check>
<label for=m-providersrodsecurity-check><a href=../../../providers/rod/security/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersrodsecurity><span>Dealing with security incidents</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersroddowntimes-li><input type=checkbox id=m-providersroddowntimes-check>
<label for=m-providersroddowntimes-check><a href=../../../providers/rod/downtimes/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersroddowntimes><span>Managing downtimes</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersrodalarms-tickets-li><input type=checkbox id=m-providersrodalarms-tickets-check>
<label for=m-providersrodalarms-tickets-check><a href=../../../providers/rod/alarms-tickets/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersrodalarms-tickets><span>Handling alarms and tickets</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-providersrodfaq-li><input type=checkbox id=m-providersrodfaq-check>
<label for=m-providersrodfaq-check><a href=../../../providers/rod/faq/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-providersrodfaq><span>FAQ</span></a></label></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta pb-1 pt-2 mb-0"><a href=https://github.com/EGI-Federation/documentation/edit/main/content/en/providers/check-in/sp/_index.md target=_blank><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/EGI-Federation/documentation/new/main/content/en/providers/check-in/sp/_index.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" target=_blank><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/EGI-Federation/documentation/issues/new?title=Service%20Providers" target=_blank><i class="fab fa-github fa-fw"></i> Create documentation issue</a></div><div class=td-toc><p class=td-toc-title>On this page</p><hr class=panel-line><nav id=TableOfContents><ul><li><a href=#services-eligible-for-integration>Services eligible for integration</a><ul><li><a href=#services-federated-in-egi>Services federated in EGI</a></li><li><a href=#services-not-federated-in-egi>Services not federated in EGI</a></li></ul></li><li><a href=#service-provider-integration-workflow>Service Provider integration workflow</a></li><li><a href=#general-information>General Information</a></li><li><a href=#saml-service-provider>SAML Service Provider</a><ul><li><a href=#metadata-registration>Metadata registration</a></li><li><a href=#metadata>Metadata</a></li><li><a href=#attributes>Attributes</a></li><li><a href=#attribute-based-authorisation>Attribute-based authorisation</a></li><li><a href=#service-provider-migration-to-keycloak>Service Provider Migration to Keycloak</a></li><li><a href=#references>References</a></li><li><a href=#example-saml-service-provider-configurations>Example SAML Service Provider Configurations</a></li></ul></li><li><a href=#openid-connect-service-provider>OpenID Connect Service Provider</a><ul><li><a href=#client-registration>Client registration</a></li><li><a href=#redirection-uris>Redirection URIs</a></li><li><a href=#claims>Claims</a></li><li><a href=#grant-types>Grant Types</a></li><li><a href=#endpoints>Endpoints</a></li><li><a href=#claims-based-authorisation>Claims-based authorisation</a></li><li><a href=#example-oidc-client-configurations>Example OIDC Client Configurations</a></li><li><a href=#client-migration-to-keycloak>Client Migration to Keycloak</a></li></ul></li><li><a href=#integrating-science-gateways-with-rcauth-for-obtaining-proxy-certificates>Integrating Science Gateways with RCauth for obtaining (proxy) certificates</a><ul><li><a href=#registering-a-client-at-the-master-portal>Registering a client at the Master Portal</a></li></ul></li><li><a href=#user-attributes>User attributes</a><ul><li><a href=#1-community-user-identifier>1. Community User Identifier</a></li><li><a href=#2-display-name>2. Display Name</a></li><li><a href=#3-given-name>3. Given Name</a></li><li><a href=#4-family-name>4. Family Name</a></li><li><a href=#5-username>5. Username</a></li><li><a href=#6-email-address>6. Email Address</a></li><li><a href=#7-verified-email-flag>7. Verified email flag</a></li><li><a href=#8-verified-email-list>8. Verified email list</a></li><li><a href=#9-affiliation>9. Affiliation</a></li><li><a href=#10-groups>10. Groups</a></li><li><a href=#11-capabilities>11. Capabilities</a></li><li><a href=#12-gocdb-roles>12. GOCDB Roles</a></li><li><a href=#13-assurance>13. Assurance</a></li><li><a href=#14-certentitlement>14. CertEntitlement</a></li><li><a href=#15-ssh-public-key>15. SSH Public Key</a></li><li><a href=#16-orcid-id>16. ORCID iD</a></li><li><a href=#17-subject-distinguished-name-dn-of-users-x509-certificate>17. Subject Distinguished Name (DN) of user&rsquo;s X.509 certificate</a></li><li><a href=#18-issuer-distinguished-name-dn-of-users-x509-certificate>18. Issuer Distinguished Name (DN) of user&rsquo;s X.509 certificate</a></li></ul></li><li><a href=#user-authorisation>User authorisation</a><ul><li><a href=#vogroup-membership-and-role-information>VO/group membership and role information</a></li><li><a href=#capabilities>Capabilities</a></li><li><a href=#identity-assurance>Identity Assurance</a></li><li><a href=#gocdb-roles>GOCDB Roles</a></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=../../../providers/>For Providers</a></li><li class=breadcrumb-item><a href=../../../providers/check-in/>Check-in</a></li><li class="breadcrumb-item active" aria-current=page><a href=../../../providers/check-in/sp/>Service Providers</a></li></ol></nav><div class=td-content><h1>Service Providers</h1><div class=lead>Check-in guide for Service Providers</div><header class=article-meta></header><p>This page contains information about connecting services to
<a href=https://www.egi.eu/service/check-in/>EGI Check-in</a> in order to allow user
login through Check-in and to receive users&rsquo; attributes. Check-in is connected
to a wide range of academic and social Identity Providers that users can choose
from in order to access your service.</p><h2 id=services-eligible-for-integration>Services eligible for integration</h2><p>EGI Operations, as owner of the Check-in service, must approve every request for
integration of new services with Check-in. The approval (or non-approval) is
based on some prerequisites, the relevance of the service for the EGI community
and the available resources to support the integration. The prerequisites are
described in the following sections.</p><p><strong>EGI at any time can prevent a service provider to access the Check-in
service</strong></p><h3 id=services-federated-in-egi>Services federated in EGI</h3><p>All the services that are operated by Resource Providers federated in EGI
federation and that abide to the RC OLA, and consequently to the relevant
security policies of EGI, can be connected with Check-in. Fulfilling all the
relevant EGI policies makes the service eligible in receiving attributes
released by Check-in.</p><h3 id=services-not-federated-in-egi>Services not federated in EGI</h3><p>A service not part of the EGI federation can be integrated with Check-in if the
organisation providing the service complies with the EGI security requirements
relevant to the service providers.</p><p>By accepting the policies a service provider assures that they will operate the
service in good faith, without deliberately exposing the user to security risks,
without claiming intellectual property on the data owned by the user, and
protecting sensitive data generated by the interaction of the user with the
service.</p><p>The policies that the service provider will have to accept are available in the
<a href=https://go.egi.eu/policies-and-procedures>EGI Policies and procedures page</a>
and specifically are:</p><ol><li><a href=https://documents.egi.eu/document/3015>EGI Security Policy</a></li><li><a href=https://documents.egi.eu/document/3601>Service Operations Security Policy</a></li><li><a href=https://documents.egi.eu/document/2934>Traceability and Logging Policy</a></li><li><a href=https://documents.egi.eu/document/2935>Security Incident Response Policy</a></li><li><a href=https://documents.egi.eu/document/2732>Policy on the Processing of Personal Data</a></li></ol><h2 id=service-provider-integration-workflow>Service Provider integration workflow</h2><p>To integrate your Service Provider with the EGI Check-in service, you need to
create a registration request using the
<a href=https://aai.egi.eu/federation>EGI Federation Registry Portal</a>. You can also
use the Federation Registry portal to request the reconfiguration or
deregistration of an existing deployed service. Service registration requests
typically require approval by an administrator. Please refer to the
<a href=https://federation.rciam.grnet.gr/docs>Federation Registry Documentation</a> for
more information.</p><p>The integration follows a two-step process:</p><ol><li>Register your Service Provider and test integration with the <strong>demo</strong>
instance of EGI Check-in by selecting the &ldquo;Demo&rdquo; integration environment
during registration through the EGI Federation Registry Portal. Service
registration requests require approval by an administrator. The review
process for the demo environment involves primarily the technical aspects of
the service configuration. However, moving the service to production requires
compliance with all the
<a href=#services-eligible-for-integration>eligibility criteria</a> (see Step 2). The
demo instance allows for testing authentication and authorisation through the
academic and social Identity Providers connected to Check-in without
affecting the production Check-in service. Note that while the demo instance
has identical functionality to the production instance, no information is
shared between the two systems.<ul><li>You can also test new features of Check-in that are not available in
production yet, by registering your Service Provider and testing
integration with the <strong>development</strong> instance of Check-in. In the
development instance service requests can be self-reviewed without the need
to wait for approval from an administrator. As with the demo instance, the
development instance allows for testing authentication and authorisation
without affecting the production Check-in service. <strong>NB: the list of
supported Identity Providers in the development instance is limited.
Therefore, we recommend using any of the social identity providers or the
<a href=https://sso.egi.eu/admin/>EGI SSO</a> to test the login workflow when using
the development instance.</strong></li></ul></li><li>Register your Service Provider with the <strong>production</strong> instance of EGI
Check-in by selecting the &ldquo;Production&rdquo; integration environment during
registration through the EGI Federation Registry Portal. The production
instance allows access to your service through the academic and social
Identity Providers connected to Check-in. This requires that your service
meets all the <a href=#services-eligible-for-integration>eligibility criteria</a> and
that integration has been thoroughly tested during Step 1.</li></ol><h2 id=general-information>General Information</h2><p>EGI Check-in supports two authentication and authorisation protocols that you
can choose from:</p><ol><li><a href=https://docs.oasis-open.org/security/saml/Post2.0/sstc-saml-tech-overview-2.0.html>Security Assertion Markup Language (SAML) 2.0</a></li><li><a href=https://openid.net/specs/openid-connect-core-1_0.html>OpenID Connect</a> - an
extension to <a href=https://tools.ietf.org/html/rfc6749>OAuth 2.0</a></li></ol><blockquote><p>Service providers should ensure that a proper authorisation model is put in
place: if <a href=#identity-assurance>low assurance</a> accounts, like those coming
from social media identity providers, are granted access without any vetting,
it may lead to an abuse of their service.</p></blockquote><p>Regardless of which of the two protocols you are going to use, you need to
provide the following information to connect your service to EGI Check-in:</p><ol><li>Name of the service (in English and optionally in other languages supported
by the service)</li><li>Short description of the service</li><li>Site (URL) for localised information about the service; the content found at
the URL SHOULD provide more complete information than what provided by the
description</li><li>Contact information of the following types:<ul><li>Helpdesk/Support contact information (for redirecting user)</li><li>Administrative</li><li>Technical</li><li>Security/incident response</li></ul></li><li>Privacy statement URL: The privacy policy is used to document the data
collected and processed by the service. You can use the
<a href=https://docs.google.com/document/d/1ZU7VjH3g7qcfWcz0Z8TTv-vQiVoRA_wOsuMyJaz28Og/edit>Privacy Policy template</a></li><li>Logo URL (optional for showing in catalogues); if provided, logos SHOULD:<ul><li>use a transparent background where appropriate to facilitate the usage of
logos within a user interface</li><li>use PNG, or GIF (less preferred), images</li><li>use HTTPS URLs in order to avoid mixed-content warnings within browsers</li><li>have a size larger than 40000 and smaller than 50000 characters when
encoded in base64</li></ul></li><li>Country of the service</li><li>Compliance with the <a href=https://go.egi.eu/policies-and-procedures>EGI Policies</a>
and the
<a href=https://wiki.refeds.org/display/CODE/Data+Protection+Code+of+Conduct+Home>REFEDS Data Protection Code of Conduct</a></li></ol><p>The most important URLs for each environment are listed in the table below but
more information can be found in the protocol-specific sections that follow.</p><ul class="nav nav-tabs" id=tabs-0 role=tablist><li class=nav-item><a class="nav-link active" id=tabs-0-0-tab data-toggle=tab href=#tabs-0-0 role=tab aria-controls=tabs-0-0 aria-selected=true>Production</a></li><li class=nav-item><a class=nav-link id=tabs-0-1-tab data-toggle=tab href=#tabs-0-1 role=tab aria-controls=tabs-0-1 aria-selected=false>Demo</a></li><li class=nav-item><a class=nav-link id=tabs-0-2-tab data-toggle=tab href=#tabs-0-2 role=tab aria-controls=tabs-0-2 aria-selected=false>Development</a></li></ul><div class=tabx-content id=tabs-0-content><div class="tab-pane show active" id=tabs-0-0 role=tabpanel aria-labelled-by=tabs-0-0-tab><table><thead><tr><th>Protocol</th><th>Production environment</th></tr></thead><tbody><tr><td>SAML</td><td><a href=https://aai.egi.eu/auth/realms/egi/protocol/saml/descriptor>https://aai.egi.eu/auth/realms/egi/protocol/saml/descriptor</a></td></tr><tr><td>OpenID Connect</td><td><a href=https://aai.egi.eu/auth/realms/egi/.well-known/openid-configuration>https://aai.egi.eu/auth/realms/egi/.well-known/openid-configuration</a></td></tr></tbody></table></div><div class=tab-pane id=tabs-0-1 role=tabpanel aria-labelled-by=tabs-0-1-tab><table><thead><tr><th>Protocol</th><th>Demo environment</th></tr></thead><tbody><tr><td>SAML</td><td><a href=https://aai-demo.egi.eu/auth/realms/egi/protocol/saml/descriptor>https://aai-demo.egi.eu/auth/realms/egi/protocol/saml/descriptor</a></td></tr><tr><td>OpenID Connect</td><td><a href=https://aai-demo.egi.eu/auth/realms/egi/.well-known/openid-configuration>https://aai-demo.egi.eu/auth/realms/egi/.well-known/openid-configuration</a></td></tr></tbody></table></div><div class=tab-pane id=tabs-0-2 role=tabpanel aria-labelled-by=tabs-0-2-tab><table><thead><tr><th>Protocol</th><th>Development environment</th></tr></thead><tbody><tr><td>SAML</td><td><a href=https://aai-dev.egi.eu/auth/realms/egi/protocol/saml/descriptor>https://aai-dev.egi.eu/auth/realms/egi/protocol/saml/descriptor</a></td></tr><tr><td>OpenID Connect</td><td><a href=https://aai-dev.egi.eu/auth/realms/egi/.well-known/openid-configuration>https://aai-dev.egi.eu/auth/realms/egi/.well-known/openid-configuration</a></td></tr></tbody></table></div></div><h2 id=saml-service-provider>SAML Service Provider</h2><p>To enable federated access to a web-based application, you can connect to the
EGI Check-in IdP as a SAML Service Provider (SP). Users of the application will
be redirected to Check-in in order to log in, and Check-in can authenticate them
using any of the supported backend authentication mechanisms, such as
institutional IdPs registered with eduGAIN or Social Providers. Once the user is
authenticated, EGI Check-in will return a SAML assertion to the application
containing information about the authenticated user.</p><h3 id=metadata-registration>Metadata registration</h3><p>SAML authentication relies on the use of metadata. Both parties (you as a SP and
the EGI Check-in IdP) need to exchange metadata in order to know and trust each
other. The metadata include information such as the location of the service
endpoints that need to be invoked, as well as the certificates that will be used
to sign SAML messages. The format of the exchanged metadata should be based on
the XML-based
<a href=https://docs.oasis-open.org/security/saml/v2.0/saml-metadata-2.0-os.pdf>SAML 2.0 specification</a>.
Usually, you will not need to manually create such an XML document, as this is
automatically generated by all major SAML 2.0 SP software solutions (e.g.,
Keycloak, Shibboleth, SimpleSAMLphp, and <code>mod_auth_mellon</code>). It is important
that you serve your metadata over HTTPS using a browser-friendly SSL
certificate, i.e. issued by a trusted certificate authority.</p><p>You can get the metadata of the EGI Check-in IdP Proxy on a dedicated URL that
depends on the integration environment being used:</p><ul class="nav nav-tabs" id=tabs-1 role=tablist><li class=nav-item><a class="nav-link active" id=tabs-1-0-tab data-toggle=tab href=#tabs-1-0 role=tab aria-controls=tabs-1-0 aria-selected=true>Production</a></li><li class=nav-item><a class=nav-link id=tabs-1-1-tab data-toggle=tab href=#tabs-1-1 role=tab aria-controls=tabs-1-1 aria-selected=false>Demo</a></li><li class=nav-item><a class=nav-link id=tabs-1-2-tab data-toggle=tab href=#tabs-1-2 role=tab aria-controls=tabs-1-2 aria-selected=false>Development</a></li></ul><div class=tabx-content id=tabs-1-content><div class="tab-pane show active" id=tabs-1-0 role=tabpanel aria-labelled-by=tabs-1-0-tab><table><thead><tr><th>Instance</th><th>Production environment</th></tr></thead><tbody><tr><td>Keycloak-based EGI Check-in IdP</td><td><ul><li>SAML Metadata URL: <a href=https://aai.egi.eu/auth/realms/egi/protocol/saml/descriptor>https://aai.egi.eu/auth/realms/egi/protocol/saml/descriptor</a></li><li>SAML entity ID: <code>https://aai.egi.eu/auth/realms/egi</code></li></ul></td></tr><tr><td>Legacy EGI Check-in IdP</td><td><ul><li>SAML Metadata URL: <a href=https://aai.egi.eu/proxy/saml2/idp/metadata.php>https://aai.egi.eu/proxy/saml2/idp/metadata.php</a></li><li>SAML entity ID: <code>https://aai.egi.eu/proxy/saml2/idp/metadata.php</code></li></ul></td></tr></tbody></table></div><div class=tab-pane id=tabs-1-1 role=tabpanel aria-labelled-by=tabs-1-1-tab><table><thead><tr><th>Instance</th><th>Demo environment</th></tr></thead><tbody><tr><td>Keycloak-based EGI Check-in IdP</td><td><ul><li>SAML Metadata URL: <a href=https://aai-demo.egi.eu/auth/realms/egi/protocol/saml/descriptor>https://aai-demo.egi.eu/auth/realms/egi/protocol/saml/descriptor</a></li><li>SAML entity ID: <code>https://aai-demo.egi.eu/auth/realms/egi</code></li></ul></td></tr><tr><td>Legacy EGI Check-in IdP</td><td><ul><li>SAML Metadata URL: <a href=https://aai-demo.egi.eu/proxy/saml2/idp/metadata.php>https://aai-demo.egi.eu/proxy/saml2/idp/metadata.php</a></li><li>SAML entity ID: <code>https://aai-demo.egi.eu/proxy/saml2/idp/metadata.php</code></li></ul></td></tr></tbody></table></div><div class=tab-pane id=tabs-1-2 role=tabpanel aria-labelled-by=tabs-1-2-tab><table><thead><tr><th>Instance</th><th>Development environment</th></tr></thead><tbody><tr><td>Keycloak-based EGI Check-in IdP</td><td><ul><li>SAML Metadata URL: <a href=https://aai-dev.egi.eu/auth/realms/egi/protocol/saml/descriptor>https://aai-dev.egi.eu/auth/realms/egi/protocol/saml/descriptor</a></li><li>SAML entity ID: <code>https://aai-dev.egi.eu/auth/realms/egi</code></li></ul></td></tr><tr><td>Legacy EGI Check-in IdP</td><td><ul><li>SAML Metadata URL: <a href=https://aai-dev.egi.eu/proxy/saml2/idp/metadata.php>https://aai-dev.egi.eu/proxy/saml2/idp/metadata.php</a></li><li>SAML entity ID: <code>https://aai-dev.egi.eu/proxy/saml2/idp/metadata.php</code></li></ul></td></tr></tbody></table></div></div><p>To register your SAML SP, you must submit a service registration request
through the <a href=https://aai.egi.eu/federation>Federation Registry</a>. Your request
should include essential information about your service, as outlined in the
<a href=#general-information>General Information</a> section, along with your SP&rsquo;s
metadata URL and entity ID.</p><h3 id=metadata>Metadata</h3><p>Metadata provided by your SP should contain a descriptive name of the service
that your SP represents in at least English. It is recommended to also provide
the name in other languages which are commonly used in the geographic scope of
the deployment. The name should be placed in the <code>&lt;md:ServiceName></code> in the
<code>&lt;md:AttributeConsumingService></code> container.</p><p>It is recommended that your SP metadata contains:</p><ul><li>an <code>&lt;md:SPSSODescriptor></code> role element containing<ul><li>an <code>AuthnRequestsSigned</code> and an <code>WantAssertionsSigned</code> attribute set to
<code>true</code></li><li>at least one <code>&lt;md:AssertionConsumerService></code> endpoint element</li><li>at least one <code>&lt;md:KeyDescriptor></code> element whose use attribute is omitted or
set to encryption</li><li>an <code>&lt;md:Extensions></code> element at the role level containing<ul><li>an <code>&lt;mdui:UIInfo></code> extension element containing the child elements
<code>&lt;mdui:DisplayName></code>, <code>&lt;mdui:Logo></code>, and <code>&lt;mdui:PrivacyStatementURL></code></li><li>an <code>&lt;mdattr:EntityAttributes></code> extension element for signaling Subject
Identifier requirements with previously prescribed content</li></ul></li><li>an <code>&lt;md:ContactPerson></code> element with a contactType of <code>support</code> and/or a
<code>&lt;md:ContactPerson></code> element with a contactType of <code>technical</code>. The
<code>&lt;md:ContactPerson></code> element(s) should contain at least one
<code>&lt;md:EmailAddress></code>. The support address may be used for generic support
questions about the service, while the technical contact may be contacted
regarding technical interoperability problems. The technical contact must be
responsible for the technical operation of the service represented by your
SP.</li></ul></li></ul><p>If the SP supports the Single Logout profile, then its metadata <strong>MUST</strong> contain
(within its <code>&lt;md:SPSSODescriptor></code> role element):</p><ul><li>at least one <code>&lt;md:KeyDescriptor></code> element whose use attribute is omitted or
set to signing</li><li>at least one <code>&lt;md:SingleLogoutService></code> endpoint element (this MAY be omitted
if the SP solely issues <code>&lt;samlp:LogoutRequest></code> messages containing the
<code>&lt;aslo:Asynchronous></code> extension
<a href=https://docs.oasis-open.org/security/saml/Post2.0/saml-async-slo/v1.0/cs01/saml-async-slo-v1.0-cs01.pdf>SAML2ASLO</a>)</li></ul><h3 id=attributes>Attributes</h3><p>The EGI Check-in IdP is guaranteed to release a minimal subset of the
<a href=https://refeds.org/category/research-and-scholarship>REFEDS R&S</a> attribute
bundle to connected Service Providers without administrative involvement,
subject to user consent. The following attributes constitute a minimal subset of
the R&S attribute bundle:</p><ul><li>Community User Identifier (CUID) which is a globally unique, opaque,
persistent and non-reassignable identifier identifying the user
(<code>voPersonID</code>). For users whose community identity is managed by Check-in,
this identifier is of the form <code>&lt;uniqueID>@egi.eu</code>. The <code>&lt;uniqueID></code> portion
is an opaque identifier issued by Check-in.</li><li>Email address (<code>mail</code>)</li><li>Display name (<code>displayName</code>) OR (<code>givenName</code> AND <code>sn</code>)</li></ul><p>A more extensive list of all the attributes that may be made available to
Service Providers is included in the <a href=#user-attributes>User Attribute</a> section.</p><h3 id=attribute-based-authorisation>Attribute-based authorisation</h3><blockquote><p>As mentioned in <a href=#general-information>the General Information</a>, omitting
authorisation checks may lead to abuse of the service.</p></blockquote><p>EGI Check-in provides information about the authenticated user that may be used
by Service Providers in order to control user access to resources. This
information is provided by the EGI Check-in IdP in the
<a href=#attributes>SAML attribute assertion</a>. The table below lists the SAML
attributes that are relevant for user authorisation:</p><table><thead><tr><th>Description</th><th>SAML Attribute</th></tr></thead><tbody><tr><td><a href=#vogroup-membership-and-role-information>VO/group membership/roles of the authenticated user</a></td><td><code>eduPersonEntitlement</code></td></tr><tr><td><a href=#capabilities>Capabilities</a></td><td><code>eduPersonEntitlement</code></td></tr><tr><td><a href=#gocdb-roles>GOCDB roles</a></td><td><code>eduPersonEntitlement</code></td></tr><tr><td><a href=#identity-assurance>Identity Assurance</a></td><td><code>eduPersonAssurance</code></td></tr></tbody></table><h3 id=service-provider-migration-to-keycloak>Service Provider Migration to Keycloak</h3><p>The migration guide below applies to SAML Service Providers (SPs) registered in
the <strong>Development</strong>, <strong>Demo</strong> and <strong>Production</strong> environments of Check-in.</p><p><strong>Development and Demo</strong>: Beginning March 9, 2023, SAML SPs using the legacy
Check-in IdP metadata will no longer be supported.</p><p><strong>Production</strong>: Beginning December 12, 2023, SAML SPs using the legacy
Check-in IdP metadata will no longer be supported.</p><h4 id=how-to-migrate-your-service-to-keycloak>How to Migrate your Service to Keycloak</h4><p>If your SAML SP is not yet registered in the
<a href=https://aai.egi.eu/federation>Federation Registry</a>, you will need to submit
a service registration request. This request should include essential
information about your service, as described in the
<a href=#general-information>General Information</a> section, in addition to your SAML
SP&rsquo;s metadata URL and entity ID.</p><p>If your SAML SP is already registered, please ensure the accuracy of the
information under the <strong>General</strong> tab, particularly the policy and contact
details, as well as the <strong>Protocol Specific</strong> tab.
Pay special attention to the new <strong>Requested Attributes</strong> section, which
allows you to manage the user attributes available through Check-in.</p><div class="alert alert-warning" role=alert><h4 class=alert-heading>Important</h4>If your SAML SP relies on
experimental features of Check-in which are only available in the
<strong>Development</strong> environment, you will need to re-register your SP through the
<a href=https://aai.egi.eu/federation>Federation Registry</a> using the &ldquo;Copy Service&rdquo;
functionality.</div><h5 id=new-identity-provider-metadata>New Identity Provider Metadata</h5><p>The first thing you need to do is to update the IdP metadata URL in the SP
configuration, according to the <a href=#metadata-registration>Metadata registration</a>
section.</p><h5 id=new-attributes>New Attributes</h5><p>When migrating your SP to the Keycloak-based EGI Check-in IdP, please be aware
that some attributes will no longer be supported. These deprecated attributes
will be replaced by new ones, as detailed in the table below:</p><table><thead><tr><th>Deprecated Attributes</th><th>New Attributes</th></tr></thead><tbody><tr><td><code>distinguishedName</code></td><td><code>voPersonCertificateDN</code></td></tr><tr><td><code>eduPersonScopedAffiliation</code></td><td><code>voPersonExternalAffiliation</code></td></tr><tr><td><code>eduPersonUniqueId</code></td><td><code>voPersonID</code></td></tr></tbody></table><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>The values of the deprecated attributes
will remain unchanged; only the attribute names will be different.</div><p>Ensure that you update the attribute mapping in your SP configuration to align
with the new attribute names.</p><h5 id=nameid>NameID</h5><p>Use of <code>&lt;saml:NameID></code> elements is intended for the Single Logout profile and
is not suitable for long-term identification of users.
For user identification, you should use the <code>voPersonID</code> SAML attribute, as
detailed in the <a href=#user-attributes>User attributes</a> section.
Your SAML SP should explicitly specify in its metadata the NameID formats it
supports from the following options:</p><ul><li>Persistent (<code>urn:oasis:names:tc:SAML:2.0:nameid-format:persistent</code>)</li><li>Transient (<code>urn:oasis:names:tc:SAML:2.0:nameid-format:transient</code>)</li><li>Email address (<code>urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress</code>)</li><li>Unspecified (<code>urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified</code>)</li></ul><p>Otherwise, Keycloak will assign the unspecified
(<code>urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified</code>) NameID format to
your SP.</p><h3 id=references>References</h3><ul><li><a href=https://www.keycloak.org/docs/latest/server_admin/#saml-v2-0-identity-providers>Keycloak Service Provider Documentation</a></li><li><a href=https://shibboleth.atlassian.net/wiki/spaces/SP3/overview>Shibboleth Service Provider Documentation</a></li><li><a href=https://simplesamlphp.org/docs/stable/simplesamlphp-sp.html>SimpleSAMLphp Service Provider QuickStart</a></li><li><a href=https://github.com/latchset/mod_auth_mellon>Simple SAML 2.0 service provider with mod_auth_mellon Apache module</a></li></ul><h3 id=example-saml-service-provider-configurations>Example SAML Service Provider Configurations</h3><h4 id=keycloak>Keycloak</h4><p>If you are using Keycloak as an SAML Service Provider, then you need to follow
the steps below in order to register EGI Check-in as an Identity Provider:</p><ol><li><p>Access the administrator console of your Keycloak instance and navigate to
&ldquo;Identity Providers&rdquo; and then select &ldquo;SAML v2.0&rdquo;</p><p><img src=saml-examples-keycloak-idp.png alt="Keycloak IdP Page"></p></li><li><p>In the next page, complete the following fields:</p><ul><li>Alias: <code>egi-check-in-saml</code></li><li>Display name: <code>EGI Check-in</code></li></ul><p><img src=saml-examples-keycloak-add-saml-idp-1.png alt="Add SAML IdP"></p><p>Scroll down, and complete the rest options:</p><ul><li>SAML entity descriptor: <code>https://aai.egi.eu/auth/realms/egi/protocol/saml/descriptor</code></li></ul><p><img src=saml-examples-keycloak-add-saml-idp-2.png alt="Add SAML IdP"></p><p>And then click on the &ldquo;Add&rdquo; button.</p></li><li><p>After adding EGI Check-in IdP, scroll down to the &ldquo;SAML settings&rdquo; section and
edit the following options:</p><ul><li>Principal type: <code>Attribute [Name]</code></li><li>Principal attribute: <code>urn:oid:1.3.6.1.4.1.25178.4.1.6</code></li><li>HTTP-POST binding response: <code>On</code></li><li>HTTP-POST binding for AuthnRequest: <code>Off</code></li><li>HTTP-POST binding logout: <code>Off</code></li><li>Want AuthnRequests signed: <code>Off</code></li><li>Want Assertions signed: <code>Off</code></li><li>Want Assertions encrypted: <code>On</code></li><li>Validate Signatures: <code>On</code></li></ul><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4><code>urn:oid:1.3.6.1.4.1.25178.4.1.6</code> is
the OID presentation of the <code>voPersonID</code> attribute.</div><p><img src=saml-examples-keycloak-saml-idp-saml-setting.png alt="SAML Settings"></p></li><li><p>Then, scroll down to the &ldquo;Advanced settings&rdquo; section and enable the &ldquo;Trust
Email&rdquo; option and click on &ldquo;Save&rdquo;.</p><p><img src=saml-examples-keycloak-saml-idp-advanced.png alt="Advanced Settings"></p></li><li><p>Next, you will need to create a mapper for each attribute that your Service
Provider will request from EGI Check-in Proxy. Go to the &ldquo;Mappers&rdquo; tab and
then click on &ldquo;Add Mapper&rdquo;.</p><p>For the <code>voPersonID</code> attribute you will need to add the following options:</p><ul><li>Name: <code>voPersonID</code></li><li>Sync Mode Override: <code>import</code></li><li>Mapper Type: <code>Attribute Importer</code></li><li>Attribute Name: <code>urn:oid:1.3.6.1.4.1.25178.4.1.6</code></li><li>Friendly Name: <code>voPersonID</code></li><li>Name Format: <code>ATTRIBUTE_FORMAT_URI</code></li><li>User Attribute Name: <code>voPersonID</code></li></ul><p><img src=saml-examples-keycloak-saml-vopersonid-mapper.png alt="voPersonID mapper"></p><p>And for the <code>eduperson_entitlement</code> claim:</p><ul><li>Name: <code>eduPersonEntitlement</code></li><li>Sync Mode Override: <code>Inherit</code></li><li>Mapper Type: <code>Attribute Importer</code></li><li>Attribute Name: <code>urn:oid:1.3.6.1.4.1.5923.1.1.1.7</code></li><li>Friendly Name: <code>eduPersonEntitlement</code></li><li>Name Format: <code>ATTRIBUTE_FORMAT_URI</code></li><li>User Attribute Name: <code>eduPersonEntitlement</code></li></ul><p><img src=saml-examples-keycloak-saml-edupersonentitlement-mapper.png alt="eduPersonEntitlement mapper"></p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>For other
<a href=#user-attributes>attributes</a>, create a mapper similar to the
<code>eduPersonEntitlement</code> mapper.</div></li></ol><h2 id=openid-connect-service-provider>OpenID Connect Service Provider</h2><p>Service Providers can be integrated with EGI Check-in using OpenID Connect
(OIDC) as an alternative to the SAML2 protocol. To allow this, the EGI Check-in
IdP provides an OpenID Connect (OAuth2) API based on
<a href=https://www.keycloak.org>Keycloak</a>, which has been
<a href=https://openid.net/certification/>certified by the OpenID Foundation</a>.
Interconnection with the EGI Check-in OpenID Provider allows users to sign in
using any of the supported backend authentication mechanisms, such as
institutional IdPs registered with eduGAIN or Social Providers. Once the user
has signed in, EGI Check-in can return OIDC Claims containing information about
the authenticated user.</p><h3 id=client-registration>Client registration</h3><p>Before your service can use the EGI Check-in OpenID Provider for user login, you
must submit a service registration request using
<a href=https://aai.egi.eu/federation>Federation Registry</a> in order to obtain OAuth
2.0 credentials. The client configuration should include the general information
about your service, as described in <a href=#general-information>General Information</a>
section.</p><h4 id=obtaining-oauth-20-credentials>Obtaining OAuth 2.0 credentials</h4><p>You need OAuth 2.0 credentials, which typically include a client ID and client
secret, to authenticate users through the EGI Check-in OpenID Provider.</p><p>You can specify the client ID and secret when creating/editing your client or
let them being automatically generated during registration (<em>recommended</em>).</p><p>To find the ID and secret of your client, do the following:</p><ol><li>Select your client from the
<a href=https://aai.egi.eu/federation>Manage Services Page</a>.</li><li>Look for the <strong>Client ID</strong> in the <strong>Protocol</strong> tab.</li><li>Select the <strong>Display/edit client secret:</strong> option from the <strong>Protocol</strong> tab.</li></ol><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>You can copy these values using the
green copy button next to the desired field.</div><h3 id=redirection-uris>Redirection URIs</h3><p>OpenID Connect Services <strong>MUST</strong> pre-register one or more Redirection URI(s) to
which authentication responses from EGI Check-in will be sent. EGI Check-in
utilises exact matching of the redirect URI specified in an authentication
request against the pre-registered URIs
<a href=https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics#section-4.1>OAuth2-BCP</a>,
with the matching performed as described in
<a href=https://www.rfc-editor.org/rfc/rfc3986#section-6.2.1>RFC3986</a> (Simple String
Comparison). Redirection URIs <strong>MUST</strong> use the schemata defined in Section
3.1.2.1 of the
<a href=https://openid.net/specs/openid-connect-core-1_0.html#AuthRequest>OIDC-Core</a>
specification. Note that the Redirection URI <strong>MUST</strong> use the <code>https</code> scheme;
the use of <code>http</code> Redirection URIs is only allowed in the development
environment.</p><h3 id=claims>Claims</h3><p>The EGI Check-in UserInfo Endpoint is an OAuth 2.0 Protected Resource that
returns specific information about the authenticated end user as Claim Values.
To obtain the requested Claims about the end user, the Client makes a request to
the UserInfo Endpoint using an Access Token obtained through OpenID Connect
Authentication. The scopes associated with the Access Token used to access the
EGI Check-in UserInfo Endpoint will determine what Claims will be released.
These Claims are represented by a JSON object that contains a collection of name
and value pairs for the Claims.</p><p>The following scope values can be used to request Claims from the EGI Check-in
UserInfo Endpoint:</p><table><thead><tr><th>Scope</th><th>Claims</th></tr></thead><tbody><tr><td><code>openid</code></td><td><code>sub</code></td></tr><tr><td><code>voperson_id</code></td><td><code>voperson_id</code></td></tr><tr><td><code>profile</code></td><td><ul><li><code>name</code></li><li><code>given_name</code></li><li><code>family_name</code></li><li><code>preferred_username</code></li></ul></td></tr><tr><td><code>email</code></td><td><ul><li><code>email</code></li><li><code>email_verified</code></li><li><code>voperson_verified_email</code></li></ul></td></tr><tr><td><code>aarc</code></td><td><ul><li><code>name</code></li><li><code>given_name</code></li><li><code>family_name</code></li><li><code>preferred_username</code></li><li><code>email</code></li><li><code>email_verified</code></li><li><code>voperson_verified_email</code></li><li><code>voperson_certificate_dn</code></li><li><code>voperson_certificate_issuer_dn</code></li><li><code>voperson_external_affiliation</code></li><li><code>voperson_id</code></li></ul></td></tr><tr><td><code>eduperson_entitlement</code></td><td><code>eduperson_entitlement</code></td></tr><tr><td><code>voperson_certificate</code></td><td><ul><li><code>voperson_certificate_dn</code></li><li><code>voperson_certificate_issuer_dn</code></li></ul></td></tr><tr><td><code>voperson_external_affiliation</code></td><td><code>voperson_external_affiliation</code></td></tr></tbody></table><p>A more extensive list of all the attributes that may be made available to
Service Providers is included in the <a href=#user-attributes>User Attribute</a> section.</p><h3 id=grant-types>Grant Types</h3><p>Check-in supports the following OpenID Connect/OAuth2 grant types:</p><ul><li>Authorization Code: used by Web Apps executing on a server.</li><li>Token Exchange: used by clients to request and obtain security tokens in
support of delegated access to resources.</li><li>Device Code: used by devices that lack a browser to perform a user-agent based
OAuth flow.</li><li>Client credentials: used by clients to obtain an access token outside of the
context of a user. Such an access token is typically used by clients to access
resources about themselves rather than to access a user&rsquo;s resources.</li></ul><h4 id=authorization-code>Authorization Code</h4><p>The Authorization Code Flow returns an Authorization Code to the Client, which
can then exchange it for an ID Token and an Access Token directly. This provides
the benefit of not exposing any tokens to the User Agent and possibly other
malicious applications with access to the User Agent. The Authorization Server
can also authenticate the Client before exchanging the Authorization Code for an
Access Token. The Authorization Code flow is suitable for Clients that can
securely maintain a Client Secret between themselves and the Authorization
Server.</p><h5 id=authorization-code-flow-steps>Authorization Code Flow Steps</h5><p>The Authorization Code Flow goes through the following steps.</p><ol><li>Client prepares an Authentication Request containing the desired request
parameters.</li><li>Client sends the request to the Authorization Server.</li><li>Authorization Server Authenticates the end user.</li><li>Authorization Server obtains end user Consent/Authorization.</li><li>Authorization Server sends the end user back to the Client with an
Authorization Code.</li><li>Client requests a response using the Authorization Code at the Token
Endpoint.</li><li>Client receives a response that contains an ID Token and Access Token in the
response body.</li><li>Client validates the ID token and retrieves the end user&rsquo;s Subject
Identifier.</li></ol><h5 id=authentication-request>Authentication Request</h5><p>The request parameters of the Authorization Endpoint are:</p><ul><li><code>client_id</code>: ID of the client that ask for authentication to the Authorization
Server.</li><li><code>redirect_uri</code>: URI to which the response will be sent.</li><li><code>scope</code>: A list of attributes that the application requires.</li><li><code>state</code>: Opaque value used to maintain state between the request and the
callback.</li><li><code>response_type</code>: value that determines the authorization processing flow to be
used. For <strong>Authorization Code</strong> grant set <code>response_type=code</code>. This way the
response will include an Authorization Code.</li></ul><p>Example request:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#a40000>  </span><span style=color:#204a87;font-weight:700>HTTP</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#0000cf;font-weight:700>1.1</span> <span style=color:#0000cf;font-weight:700>302</span> <span style=color:#c00;font-weight:700>Found</span>
</span></span><span style=display:flex><span>  <span style=color:#000>Location: ${AUTHORIZATION_ENDPOINT}?</span>
</span></span><span style=display:flex><span>    <span style=color:#000>response_type=code</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&amp;scope=openid%20profile%20email</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&amp;client_id=s6BhdRkqt3</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&amp;state=af0ifabcd</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb</span>
</span></span></code></pre></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>You can find the
<code>AUTHORIZATION_ENDPOINT</code> in the <a href=#endpoints>Endpoints</a> table.</div><p>Example response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#a40000>  </span><span style=color:#204a87;font-weight:700>HTTP</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#0000cf;font-weight:700>1.1</span> <span style=color:#0000cf;font-weight:700>302</span> <span style=color:#c00;font-weight:700>Found</span>
</span></span><span style=display:flex><span>  <span style=color:#000>Location: https://client.example.org/cb?</span>
</span></span><span style=display:flex><span>    <span style=color:#000>code=SplxlOBeZQQYbYS6WxSbIA</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&amp;state=af0ifabcd</span>
</span></span></code></pre></div><h5 id=token-request>Token Request</h5><p>A Client makes a Token Request by presenting its Authorization Grant (in the
form of an Authorization Code) to the Token Endpoint using the <code>grant_type</code>
value <code>authorization_code</code>, as described in Section 4.1.3 of OAuth 2.0
<a href=https://www.rfc-editor.org/rfc/rfc6749#section-4.1.3>RFC6749</a>. If the Client
is a Confidential Client, then it <strong>MUST</strong> authenticate to the Token Endpoint
using the authentication method registered for its <code>client_id</code>. The Client sends
the parameters to the Token Endpoint using the HTTP <code>POST</code> method and the Form
Serialization.</p><p>The parameters that are present in the token request are described in the table
below:</p><table><thead><tr><th>Parameter</th><th>Presence</th><th>Values</th></tr></thead><tbody><tr><td><code>grant_type</code></td><td>Required</td><td><code>authorization_code</code></td></tr><tr><td><code>code</code></td><td>Required</td><td>The value of the code in the response from Authorization Endpoint</td></tr><tr><td><code>redirect_uri</code></td><td>Required</td><td>URI to which the response will be sent (must be the same as the request to Authorization Endpoint)</td></tr></tbody></table><p>Example request:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ curl -X POST <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>TOKEN_ENDPOINT</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -H <span style=color:#4e9a06>&#39;Content-Type: application/x-www-form-urlencoded&#39;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -u <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>CLIENT_ID</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span>:<span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>CLIENT_SECRET</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;grant_type=authorization_code&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;code=SplxlOBeZQQYbYS6WxSbIA&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb&#34;</span> <span style=color:#000;font-weight:700>|</span> python -m json.tool
</span></span></code></pre></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>You can find the <code>TOKEN_ENDPOINT</code> in the
<a href=#endpoints>Endpoints</a> table.</div><p>Example response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;access_token&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;SlAV32hkKG...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;expires_in&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>3600</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;id_token&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;eyabcdGciOiJSUzI1N...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;token_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Bearer&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=proof-key-for-code-exchange-pkce>Proof Key for Code Exchange (PKCE)</h4><p>The Proof Key for Code Exchange (PKCE, pronounced pixie) extension
(<a href=https://tools.ietf.org/html/rfc7636>RFC 7636</a>) describes a technique for
public clients (clients without <code>client_secret</code>) to mitigate the threat of
having the Authorization Code intercepted. The technique involves the client
first creating a secret, and then using that secret again when exchanging the
Authorization Code for an access token. This way if the code is intercepted, it
will not be useful since the token request relies on the initial secret.</p><h5 id=client-configuration>Client configuration</h5><p>To enable PKCE you need to go to the
<a href=https://aai.egi.eu/federation>Manage Services Page</a> and create/edit a client.
In &ldquo;Protocol&rdquo; tab under &ldquo;Token Endpoint Authentication Method&rdquo; select &ldquo;No
authentication&rdquo; and in &ldquo;Crypto&rdquo; tab under &ldquo;Proof Key for Code Exchange (PKCE)
Code Challenge Method&rdquo; select &ldquo;SHA-256 hash algorithm&rdquo;.</p><h5 id=protocol-flow>Protocol Flow</h5><p>Because the PKCE-enhanced Authorization Code Flow builds upon the standard
Authorization Code Flow, the steps are very similar.</p><p>First, the client creates and records a secret named the <code>code_verifier</code>. The
<code>code_verifier</code> is a high-entropy cryptographic random STRING using the
unreserved characters [A-Z] / [a-z] / [0-9] / &ldquo;-&rdquo; / &ldquo;.&rdquo; / &ldquo;_&rdquo; / &ldquo;~&rdquo;, with a
minimum length of 43 characters and a maximum length of 128 characters. Then the
client creates a <code>code_challenge</code> derived from the <code>code_verifier</code> by using one
of the following transformations on the code verifier:</p><ul><li><code>plain</code> code_challenge = code_verifier</li><li><code>S256</code> code_challenge = BASE64URL-ENCODE(SHA256(ASCII(code_verifier)))</li></ul><p>If the client is capable of using <code>S256</code>, it MUST use <code>S256</code>. Clients are
permitted to use <code>plain</code> only if they cannot support <code>S256</code> for some technical
reason.</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>There are various tools that generate
these values such as <a href=https://tonyxu-io.github.io/pkce-generator/>https://tonyxu-io.github.io/pkce-generator/</a></div><p>Then the <code>code_challenge</code> is sent in the Authorization Request along with the
transformation method (<code>code_challenge_method</code>).</p><p>Example request:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#a40000>  </span><span style=color:#204a87;font-weight:700>HTTP</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#0000cf;font-weight:700>1.1</span> <span style=color:#0000cf;font-weight:700>302</span> <span style=color:#c00;font-weight:700>Found</span>
</span></span><span style=display:flex><span>  <span style=color:#000>Location: ${AUTHORIZATION_ENDPOINT}?</span>
</span></span><span style=display:flex><span>      <span style=color:#000>client_id=${CLIENT_ID}</span>
</span></span><span style=display:flex><span>      <span style=color:#000>&amp;scope=openid%20profile%20email</span>
</span></span><span style=display:flex><span>      <span style=color:#000>&amp;redirect_uri=${REDIRECT_URI}</span>
</span></span><span style=display:flex><span>      <span style=color:#000>&amp;response_type=code</span>
</span></span><span style=display:flex><span>      <span style=color:#000>&amp;code_challenge=${CODE_CHALLENGE}</span>
</span></span><span style=display:flex><span>      <span style=color:#000>&amp;code_challenge_method=S256</span>
</span></span></code></pre></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>You can find the
<code>AUTHORIZATION_ENDPOINT</code> in the <a href=#endpoints>Endpoints</a> table.</div><p>The Authorization Endpoint responds as usual but records <code>code_challenge</code> and
the <code>code_challenge_method</code>.</p><p>Example response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#a40000>  </span><span style=color:#204a87;font-weight:700>HTTP</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#0000cf;font-weight:700>1.1</span> <span style=color:#0000cf;font-weight:700>302</span> <span style=color:#c00;font-weight:700>Found</span>
</span></span><span style=display:flex><span>  <span style=color:#000>Location: ${REDIRECT_URI}?code=fgtLHT</span>
</span></span></code></pre></div><p>The client then sends the Authorization Code in the Access Token Request as
usual but includes the <code>code_verifier</code> secret generated in the first request.</p><p>Example request:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ curl -X POST <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>TOKEN_ENDPOINT</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;grant_type=authorization_code&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;code=</span><span style=color:#4e9a06>${</span><span style=color:#000>CODE</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;client_id=</span><span style=color:#4e9a06>${</span><span style=color:#000>CLIENT_ID</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;redirect_uri=</span><span style=color:#4e9a06>${</span><span style=color:#000>REDIRECT_URI</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;code_verifier=</span><span style=color:#4e9a06>${</span><span style=color:#000>CODE_VERIFIER</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#000;font-weight:700>|</span> python -m json.tool
</span></span></code></pre></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>You can find the <code>TOKEN_ENDPOINT</code> in the
<a href=#endpoints>Endpoints</a> table.</div><p>The Authorization Server transforms <code>code_verifier</code> and compares it to
<code>code_challenge</code> from the first request. Access is denied if they are not equal.</p><p>Example response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;access_token&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;eyJraWQiOiJvaWRjIiwiYWxnIjoiUlMyNTYifQ...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;expires_in&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>3599</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;id_token&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;eyJraWQiOiJvaWRjIiwiYWxnIjoiUlMyNTYifQ...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;scope&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;openid email profile&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;token_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Bearer&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=refresh-flow>Refresh flow</h4><p>The following request allows obtaining an access token from a refresh token
using the <code>grant_type</code> value <code>refresh_token</code>:</p><table><thead><tr><th>Parameter</th><th>Presence</th><th>Values</th></tr></thead><tbody><tr><td><code>client_id</code></td><td>Required</td><td>The identifier of the client.</td></tr><tr><td><code>client_secret</code></td><td>Required</td><td>The secret value of the client.</td></tr><tr><td><code>grant_type</code></td><td>Required</td><td><code>refresh_token</code></td></tr><tr><td><code>refresh_token</code></td><td>Required</td><td><code>The value of the refresh token</code></td></tr><tr><td><code>scope</code></td><td>Required</td><td>This parameter should contain openid at least</td></tr></tbody></table><p>Example request:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ curl -X POST <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>TOKEN_ENDPOINT</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -u <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>CLIENT_ID</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span>:<span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>CLIENT_SECRET</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;grant_type=refresh_token&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;refresh_token=</span><span style=color:#4e9a06>${</span><span style=color:#000>REFRESH_TOKEN</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;scope=openid%20email%20profile&#34;</span> <span style=color:#000;font-weight:700>|</span> python -m json.tool<span style=color:#000;font-weight:700>;</span>
</span></span></code></pre></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>You can find the <code>TOKEN_ENDPOINT</code> in the
<a href=#endpoints>Endpoints</a> table.</div><p>Example response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;access_token&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;eyJraWQiOiJvaWRjIiwiYWx...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;expires_in&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>3599</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;id_token&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;eyJraWQiOiJvaWRjIiwiYW...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;refresh_token&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;eyabcdGciOiJub25...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;scope&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;openid profile email&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;token_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Bearer&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h5 id=refresh-request-when-using-pkce>Refresh Request when using PKCE</h5><p>To combine the refresh token grant type with PKCE you need to make the following
request:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ curl -X POST <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>TOKEN_ENDPOINT</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;client_id=</span><span style=color:#4e9a06>${</span><span style=color:#000>CLIENT_ID</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;grant_type=refresh_token&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;refresh_token=</span><span style=color:#4e9a06>${</span><span style=color:#000>REFRESH_TOKEN</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;scope=openid%20email%20profile&#34;</span> <span style=color:#000;font-weight:700>|</span> python -m json.tool<span style=color:#000;font-weight:700>;</span>
</span></span></code></pre></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>You can find the <code>TOKEN_ENDPOINT</code> in the
<a href=#endpoints>Endpoints</a> table.</div><h4 id=token-exchange>Token Exchange</h4><p>To get a token from client B using a token issued for client A, the parameters
of the request are:</p><table><thead><tr><th>Parameter</th><th>Presence</th><th>Values</th></tr></thead><tbody><tr><td><code>grant_type</code></td><td>Required</td><td><code>urn:ietf:params:oauth:grant-type:token-exchange</code></td></tr><tr><td><code>audience</code></td><td>Optional</td><td>Define the logical name of the service that the token will be used for</td></tr><tr><td><code>subject_token</code></td><td>Required</td><td>The value of the access token</td></tr><tr><td><code>subject_token_type</code></td><td>Required</td><td><code>urn:ietf:params:oauth:token-type:access_token</code> (because this feature accepts access tokens only)</td></tr><tr><td><code>scope</code></td><td>Optional</td><td>Define one or more scopes that are contained in the original token; otherwise all scopes will be selected</td></tr></tbody></table><p>Example request:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ curl -X POST <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>TOKEN_ENDPOINT</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -u <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>CLIENT_B_ID</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span>:<span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>CLIENT_B_SECRET</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;grant_type=urn:ietf:params:oauth:grant-type:token-exchange&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;subject_token=</span><span style=color:#4e9a06>${</span><span style=color:#000>ACCESS_TOKEN_A</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;subject_token_type=urn:ietf:params:oauth:token-type:access_token&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;scope=openid%20profile%20offline_access&#34;</span> <span style=color:#000;font-weight:700>|</span> python -m json.tool<span style=color:#000;font-weight:700>;</span>
</span></span></code></pre></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>You can find the <code>TOKEN_ENDPOINT</code> in the
<a href=#endpoints>Endpoints</a> table.</div><p>Example response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;access_token&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;eyJraWQiOiJvaWRjIiwiYWxnIjoiUl...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;expires_in&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>3599</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;id_token&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;eyJraWQiOiJvaWRjIiwiYWxnIjoiUl...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;refresh_token&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;eyabcdGciOiJub25lIn0.eyJleHAiO...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;scope&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;openid profile offline_access&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;token_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Bearer&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=device-code>Device Code</h4><p>The device code flow enables OAuth clients on (input-constrained) devices to
obtain user authorisation for accessing protected resources without using an
on-device user-agent, provided that they have an internet connection.</p><h5 id=1-device-authorization-request>1. Device Authorization Request</h5><p>The client initiates the authorisation flow by requesting a set of verification
codes from the Authorization Server by making an HTTP &ldquo;POST&rdquo; request to the
device Authorization Endpoint. The client constructs the request with the
following parameters:</p><table><thead><tr><th>Parameter</th><th>Presence</th><th>Values</th></tr></thead><tbody><tr><td><code>client_id</code></td><td>Required</td><td>The identifier of the client</td></tr><tr><td><code>scope</code></td><td>Optional</td><td>Define one or more scopes that are contained in the original token; otherwise all scopes will be selected</td></tr></tbody></table><p>Example request:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ curl -X POST <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>DEVICE_AUTHORIZATION_ENDPOINT</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -H <span style=color:#4e9a06>&#34;Content-Type: application/x-www-form-urlencoded&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;client_id=</span><span style=color:#4e9a06>${</span><span style=color:#000>CLIENT_ID</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;client_secret=</span><span style=color:#4e9a06>${</span><span style=color:#000>CLIENT_SECRET</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;scope=openid%20email%20profile&#34;</span> <span style=color:#000;font-weight:700>|</span> python -m json.tool
</span></span></code></pre></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>You can find the
<code>DEVICE_AUTHORIZATION_ENDPOINT</code> in the <a href=#endpoints>Endpoints</a>
table.</div><p>Example response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;device_code&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;HvtHOpSah_Anupq-0dtzvN7cb-wcnwxytiMzpBZBN6E&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;expires_in&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>600</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;interval&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;user_code&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;NMEM-SDPK&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;verification_uri&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;https://aai.egi.eu/auth/realms/egi/device&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;verification_uri_complete&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;https://aai.egi.eu/auth/realms/egi/device?user_code=NMEM-SDPK&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h5 id=2-user-interaction>2. User Interaction</h5><p>After receiving a successful Authorization Response, the client displays or
otherwise communicates the <code>user_code</code> and the <code>verification_uri</code> to the end
user and instructs them to visit the URI in a user agent on a secondary device
(for example, in a browser on their mobile phone), and enter the user code.</p><h5 id=3-device-access-token-request>3. Device Access Token Request</h5><p>After displaying instructions to the user, the client makes an Access Token
Request to the token endpoint. The request contains the following parameters:</p><table><thead><tr><th>Parameter</th><th>Presence</th><th>Values</th></tr></thead><tbody><tr><td><code>grant_type</code></td><td>Required</td><td><code>urn:ietf:params:oauth:grant-type:device_code</code></td></tr><tr><td><code>device_code</code></td><td>Required</td><td>The device verification code, <code>device_code</code> from the Device Authorization Response</td></tr><tr><td><code>client_id</code></td><td>Required</td><td>The identifier of the client</td></tr><tr><td><code>client_secret</code></td><td>Required</td><td>The secret value of the client</td></tr><tr><td><code>scope</code></td><td>Optional</td><td>Define one or more scopes that are contained in the original token; otherwise all scopes will be selected</td></tr></tbody></table><p>Example request:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ curl -X POST <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>TOKEN_ENDPOINT</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -H <span style=color:#4e9a06>&#34;Content-Type: application/x-www-form-urlencoded&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Adevice_code&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;device_code=</span><span style=color:#4e9a06>${</span><span style=color:#000>DEVICE_CODE</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;client_id=</span><span style=color:#4e9a06>${</span><span style=color:#000>CLIENT_ID</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;client_secret=</span><span style=color:#4e9a06>${</span><span style=color:#000>CLIENT_SECRET</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;scope=openid%20profile&#34;</span> <span style=color:#000;font-weight:700>|</span> python -m json.tool
</span></span></code></pre></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>You can find the <code>TOKEN_ENDPOINT</code> in the
<a href=#endpoints>Endpoints</a> table.</div><p>Example response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;access_token&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;eyJraWQiOiJyc2ExIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJhZG1pbiIs...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;expires_in&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>3599</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;id_token&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;eyJraWQiOiJyc2ExIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiI5MDM0Mi...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;scope&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;openid profile&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;token_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Bearer&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h5 id=device-code-with-pkce>Device Code with PKCE</h5><p>To combine Device Code flow with PKCE you need to make the following requests:</p><p>1 - Device Authorization Request:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ curl -X POST <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>DEVICE_AUTHORIZATION_ENDPOINT</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -H <span style=color:#4e9a06>&#34;Content-Type: application/x-www-form-urlencoded&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;client_id=</span><span style=color:#4e9a06>${</span><span style=color:#000>CLIENT_ID</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;client_secret=</span><span style=color:#4e9a06>${</span><span style=color:#000>CLIENT_SECRET</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;scope=openid%20email%20profile&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;code_challenge=</span><span style=color:#4e9a06>${</span><span style=color:#000>CODE_CHALLENGE</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;code_challenge_method=S256&#34;</span> <span style=color:#000;font-weight:700>|</span> python -m json.tool
</span></span></code></pre></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>You can find the
<code>DEVICE_AUTHORIZATION_ENDPOINT</code> in the <a href=#endpoints>Endpoints</a>
table.</div><p>2 - Device Access Token Request</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ curl -X POST <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>TOKEN_ENDPOINT</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -H <span style=color:#4e9a06>&#34;Content-Type: application/x-www-form-urlencoded&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Adevice_code&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;device_code=</span><span style=color:#4e9a06>${</span><span style=color:#000>DEVICE_CODE</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;client_id=</span><span style=color:#4e9a06>${</span><span style=color:#000>CLIENT_ID</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;client_secret=</span><span style=color:#4e9a06>${</span><span style=color:#000>CLIENT_SECRET</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;code_verifier=</span><span style=color:#4e9a06>${</span><span style=color:#000>CODE_VERIFIER</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#000;font-weight:700>|</span> python -m json.tool
</span></span></code></pre></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>You can find the <code>TOKEN_ENDPOINT</code> in the
<a href=#endpoints>Endpoints</a> table.</div><h4 id=client-credentials>Client credentials</h4><p>The parameters that are used in the Client Credentials flow are:</p><table><thead><tr><th>Parameter</th><th>Presence</th><th>Values</th></tr></thead><tbody><tr><td><code>grant_type</code></td><td>Required</td><td><code>client_credentials</code></td></tr><tr><td><code>scope</code></td><td>Optional</td><td>Define scope(s) to request</td></tr></tbody></table><p>Example request:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ curl -X POST <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>TOKEN_ENDPOINT</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -u <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>CLIENT_ID</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span>:<span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>CLIENT_SECRET</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -H <span style=color:#4e9a06>&#34;Content-Type: application/x-www-form-urlencoded&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;grant_type=client_credentials&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;scope=openid%20email%20profile%20eduperson_entitlement%20voperson_id&#34;</span> <span style=color:#000;font-weight:700>|</span> python -m json.tool<span style=color:#000;font-weight:700>;</span>
</span></span></code></pre></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>You can find the <code>TOKEN_ENDPOINT</code> in the
<a href=#endpoints>Endpoints</a> table.</div><p>Example response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;access_token&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;eyJraWQiOiJvaWRjIiwiYWxnIjoiUl...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;expires_in&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>3599</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;id_token&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;eyJraWQiOiJvaWRjIiwiYWxnIjoiUl...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;not-before-policy&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;refresh_expires_in&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;scope&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;openid eduperson_entitlement voperson_id profile email&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;token_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Bearer&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>Example Access Token (decoded payload):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;azp&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;1deb9fbd-44a3-4dff-ab4a-49e092e7f566&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;clientAddress&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;xxx.xxx.xxx.xxx&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;clientHost&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;xxx.xxx.xxx.xxx&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;client_id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;1deb9fbd-44a3-4dff-ab4a-49e092e7f566&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;exp&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1674473629</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;iat&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1674470029</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;iss&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;https://aai.egi.eu/auth/realms/egi&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;jti&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;bdf15737-01ba-4e61-b5bc-3304d637e2b6&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;scope&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;openid eduperson_entitlement voperson_id profile email&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;sub&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;253b69f3-2325-4fd5-a26d-95e26b42bbaf@egi.eu&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;typ&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Bearer&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;voperson_id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;253b69f3-2325-4fd5-a26d-95e26b42bbaf@egi.eu&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=endpoints>Endpoints</h3><p>The most important OIDC/OAuth2 endpoints are listed below:</p><ul class="nav nav-tabs" id=tabs-20 role=tablist><li class=nav-item><a class="nav-link active" id=tabs-20-0-tab data-toggle=tab href=#tabs-20-0 role=tab aria-controls=tabs-20-0 aria-selected=true>Production</a></li><li class=nav-item><a class=nav-link id=tabs-20-1-tab data-toggle=tab href=#tabs-20-1 role=tab aria-controls=tabs-20-1 aria-selected=false>Demo</a></li><li class=nav-item><a class=nav-link id=tabs-20-2-tab data-toggle=tab href=#tabs-20-2 role=tab aria-controls=tabs-20-2 aria-selected=false>Development</a></li></ul><div class=tabx-content id=tabs-20-content><div class="tab-pane show active" id=tabs-20-0 role=tabpanel aria-labelled-by=tabs-20-0-tab><table><thead><tr><th>Endpoints</th><th>Production environment</th></tr></thead><tbody><tr><td>Provider configuration</td><td><a href=https://aai.egi.eu/auth/realms/egi/.well-known/openid-configuration>https://aai.egi.eu/auth/realms/egi/.well-known/openid-configuration</a></td></tr><tr><td>Issuer</td><td><a href=https://aai.egi.eu/auth/realms/egi>https://aai.egi.eu/auth/realms/egi</a></td></tr><tr><td>Authorization</td><td><a href=https://aai.egi.eu/auth/realms/egi/protocol/openid-connect/auth>https://aai.egi.eu/auth/realms/egi/protocol/openid-connect/auth</a></td></tr><tr><td>Token</td><td><a href=https://aai.egi.eu/auth/realms/egi/protocol/openid-connect/token>https://aai.egi.eu/auth/realms/egi/protocol/openid-connect/token</a></td></tr><tr><td>Device Authorization</td><td><a href=https://aai.egi.eu/auth/realms/egi/protocol/openid-connect/auth/device>https://aai.egi.eu/auth/realms/egi/protocol/openid-connect/auth/device</a></td></tr><tr><td>JSON Web Key Sets(JWKS)</td><td><a href=https://aai.egi.eu/auth/realms/egi/protocol/openid-connect/certs>https://aai.egi.eu/auth/realms/egi/protocol/openid-connect/certs</a></td></tr><tr><td>UserInfo</td><td><a href=https://aai.egi.eu/auth/realms/egi/protocol/openid-connect/userinfo>https://aai.egi.eu/auth/realms/egi/protocol/openid-connect/userinfo</a></td></tr><tr><td>Introspection</td><td><a href=https://aai.egi.eu/auth/realms/egi/protocol/openid-connect/token/introspect>https://aai.egi.eu/auth/realms/egi/protocol/openid-connect/token/introspect</a></td></tr><tr><td>Logout</td><td><a href=https://aai.egi.eu/auth/realms/egi/protocol/openid-connect/logout>https://aai.egi.eu/auth/realms/egi/protocol/openid-connect/logout</a></td></tr></tbody></table></div><div class=tab-pane id=tabs-20-1 role=tabpanel aria-labelled-by=tabs-20-1-tab><table><thead><tr><th>Endpoints</th><th>Demo environment</th></tr></thead><tbody><tr><td>Provider configuration</td><td><a href=https://aai-demo.egi.eu/auth/realms/egi/.well-known/openid-configuration>https://aai-demo.egi.eu/auth/realms/egi/.well-known/openid-configuration</a></td></tr><tr><td>Issuer</td><td><a href=https://aai-demo.egi.eu/auth/realms/egi>https://aai-demo.egi.eu/auth/realms/egi</a></td></tr><tr><td>Authorization</td><td><a href=https://aai-demo.egi.eu/auth/realms/egi/protocol/openid-connect/auth>https://aai-demo.egi.eu/auth/realms/egi/protocol/openid-connect/auth</a></td></tr><tr><td>Token</td><td><a href=https://aai-demo.egi.eu/auth/realms/egi/protocol/openid-connect/token>https://aai-demo.egi.eu/auth/realms/egi/protocol/openid-connect/token</a></td></tr><tr><td>Device Authorization</td><td><a href=https://aai-demo.egi.eu/auth/realms/egi/protocol/openid-connect/auth/device>https://aai-demo.egi.eu/auth/realms/egi/protocol/openid-connect/auth/device</a></td></tr><tr><td>JSON Web Key Sets(JWKS)</td><td><a href=https://aai-demo.egi.eu/auth/realms/egi/protocol/openid-connect/certs>https://aai-demo.egi.eu/auth/realms/egi/protocol/openid-connect/certs</a></td></tr><tr><td>UserInfo</td><td><a href=https://aai-demo.egi.eu/auth/realms/egi/protocol/openid-connect/userinfo>https://aai-demo.egi.eu/auth/realms/egi/protocol/openid-connect/userinfo</a></td></tr><tr><td>Introspection</td><td><a href=https://aai-demo.egi.eu/auth/realms/egi/protocol/openid-connect/token/introspect>https://aai-demo.egi.eu/auth/realms/egi/protocol/openid-connect/token/introspect</a></td></tr><tr><td>Logout</td><td><a href=https://aai-demo.egi.eu/auth/realms/egi/protocol/openid-connect/logout>https://aai-demo.egi.eu/auth/realms/egi/protocol/openid-connect/logout</a></td></tr></tbody></table></div><div class=tab-pane id=tabs-20-2 role=tabpanel aria-labelled-by=tabs-20-2-tab><table><thead><tr><th>Endpoints</th><th>Development environment</th></tr></thead><tbody><tr><td>Provider configuration</td><td><a href=https://aai-dev.egi.eu/auth/realms/egi/.well-known/openid-configuration>https://aai-dev.egi.eu/auth/realms/egi/.well-known/openid-configuration</a></td></tr><tr><td>Issuer</td><td><a href=https://aai-dev.egi.eu/auth/realms/egi>https://aai-dev.egi.eu/auth/realms/egi</a></td></tr><tr><td>Authorization</td><td><a href=https://aai-dev.egi.eu/auth/realms/egi/protocol/openid-connect/auth>https://aai-dev.egi.eu/auth/realms/egi/protocol/openid-connect/auth</a></td></tr><tr><td>Token</td><td><a href=https://aai-dev.egi.eu/auth/realms/egi/protocol/openid-connect/token>https://aai-dev.egi.eu/auth/realms/egi/protocol/openid-connect/token</a></td></tr><tr><td>Device Authorization</td><td><a href=https://aai-dev.egi.eu/auth/realms/egi/protocol/openid-connect/auth/device>https://aai-dev.egi.eu/auth/realms/egi/protocol/openid-connect/auth/device</a></td></tr><tr><td>JSON Web Key Sets(JWKS)</td><td><a href=https://aai-dev.egi.eu/auth/realms/egi/protocol/openid-connect/certs>https://aai-dev.egi.eu/auth/realms/egi/protocol/openid-connect/certs</a></td></tr><tr><td>UserInfo</td><td><a href=https://aai-dev.egi.eu/auth/realms/egi/protocol/openid-connect/userinfo>https://aai-dev.egi.eu/auth/realms/egi/protocol/openid-connect/userinfo</a></td></tr><tr><td>Introspection</td><td><a href=https://aai-dev.egi.eu/auth/realms/egi/protocol/openid-connect/token/introspect>https://aai-dev.egi.eu/auth/realms/egi/protocol/openid-connect/token/introspect</a></td></tr><tr><td>Logout</td><td><a href=https://aai-dev.egi.eu/auth/realms/egi/protocol/openid-connect/logout>https://aai-dev.egi.eu/auth/realms/egi/protocol/openid-connect/logout</a></td></tr></tbody></table></div></div><h4 id=authorization-endpoint>Authorization Endpoint</h4><p>The Authorization Endpoint performs Authentication of the end user. This is done
by sending the User Agent to the Authorization Server's Authorization Endpoint
for Authentication and Authorisation, using request parameters defined by OAuth
2.0 and additional parameters and parameter values defined by OpenID Connect.</p><p>For more information please check the
<a href=#authorization-code>Authorization Code Flow</a>.</p><h4 id=token-endpoint>Token Endpoint</h4><p>To obtain an Access Token, an ID Token, and optionally a Refresh Token, the
Client sends a Token Request to the Token Endpoint.</p><p>This endpoint is used in the following flows:</p><ul><li><a href=#authorization-code>Authorization Code</a></li><li><a href=#refresh-flow>Refresh Token</a></li><li><a href=#token-exchange>Token Exchange</a></li><li><a href=#device-code>Device Code</a></li><li><a href=#client-credentials>Client Credentials</a></li></ul><h4 id=device-authorization-endpoint>Device Authorization Endpoint</h4><p>This endpoint has been introduced in the OAuth 2.0 Device Authorization Grant
specification <a href=https://www.rfc-editor.org/rfc/rfc8628#section-3.1>RFC8628</a> and
it is used in Device Code Flow.</p><p>The OAuth client on the device interacts with the authorization server directly
without presenting the request in a user agent, and the end user authorizes the
request on a separate device. This interaction is defined as follows.</p><p>For more information please check the <a href=#device-code>Device Code Flow</a>.</p><h4 id=json-web-key-sets-endpoint>JSON Web Key Sets Endpoint</h4><p>This URL points to the Authorization Server&rsquo;s JWK Set
<a href=https://www.rfc-editor.org/info/rfc7517>JWK</a> document. The referenced document
contains the signing key(s) the client uses to validate signatures from the
authorization server.</p><h4 id=userinfo-endpoint>UserInfo Endpoint</h4><p>The UserInfo Endpoint is an OAuth 2.0 Protected Resource that returns Claims
about the authenticated end user. To obtain the requested Claims about the end
user, the Client makes a request to the UserInfo Endpoint using an Access Token
obtained through OpenID Connect Authentication. These Claims are normally
represented by a JSON object that contains a collection of name and value pairs
for the Claims.</p><h5 id=userinfo-request>UserInfo Request</h5><p>The Client sends the UserInfo Request using either HTTP <code>GET</code> or HTTP <code>POST</code>.
The Access Token obtained from an OpenID Connect Authentication Request must be
sent as a Bearer Token, per Section 2 of
<a href=https://www.rfc-editor.org/rfc/rfc6750#section-2>OAuth 2.0 Bearer Token Usage (RFC6750)</a>.</p><p>It is recommended that the request use the HTTP <code>GET</code> method and the Access
Token be sent using the Authorization header field.</p><p>Example request:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ curl -X GET <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>USERINFO_ENDPOINT</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span>
</span></span><span style=display:flex><span>    -H <span style=color:#4e9a06>&#34;Content-type: application/json&#34;</span>
</span></span><span style=display:flex><span>    -H <span style=color:#4e9a06>&#34;Authorization: Bearer </span><span style=color:#4e9a06>${</span><span style=color:#000>ACCESS_TOKEN</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#000;font-weight:700>|</span> python -m json.tool<span style=color:#000;font-weight:700>;</span>
</span></span></code></pre></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>You can find the <code>USERINFO_ENDPOINT</code> in
the <a href=#endpoints>Endpoints</a> table.</div><p>Example response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;eduperson_assurance&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;https://refeds.org/assurance/IAP/low&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;https://aai.egi.eu/LoA#Substantial&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>],</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;eduperson_entitlement&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;urn:mace:egi.eu:group:demo.fedcloud.egi.eu:members:role=member#aai.egi.eu&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;urn:mace:egi.eu:group:demo.fedcloud.egi.eu:role=member#aai.egi.eu&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;urn:mace:egi.eu:group:demo.fedcloud.egi.eu:vm_operator:role=member#aai.egi.eu&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>],</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;email&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;jdoe@example.org&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;email_verified&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;family_name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;John&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;given_name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Doe&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;John Doe&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;preferred_username&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;jdoe&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;sub&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;1234567890123456789012345678901234567890123456789012345678901234@egi.eu&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;voperson_id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;1234567890123456789012345678901234567890123456789012345678901234@egi.eu&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;voperson_verified_email&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;jdoe@example.org&#34;</span><span style=color:#000;font-weight:700>]</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=introspection-endpoint>Introspection Endpoint</h4><p>The introspection endpoint is an OAuth 2.0 endpoint that takes a parameter
representing an OAuth 2.0 token and returns a JSON document representing the
meta information surrounding the token, including whether this token is
currently active.</p><h5 id=introspection-request>Introspection Request</h5><p>The protected resource calls the introspection endpoint using an HTTP <code>POST</code>
request with parameters sent as <code>application/x-www-form-urlencoded</code>.</p><p>Example request:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ curl -X POST <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>INTROSPECTION_ENDPOINT</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -u <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>CLIENT_ID</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span>:<span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>CLIENT_SECRET</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -H <span style=color:#4e9a06>&#34;Content-Type: application/x-www-form-urlencoded&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -d <span style=color:#4e9a06>&#34;token=</span><span style=color:#4e9a06>${</span><span style=color:#000>ACCESS_TOKEN</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#000;font-weight:700>|</span> python -m json.tool<span style=color:#000;font-weight:700>;</span>
</span></span></code></pre></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>You can find the
<code>INTROSPECTION_ENDPOINT</code> in the <a href=#endpoints>Endpoints</a> table.</div><p>Example response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;active&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;auth_time&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1668613335</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;authenticating_authority&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;https://idp.admin.grnet.gr/idp/shibboleth&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;azp&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;token-portal&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;client_id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;token-portal&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;eduperson_assurance&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;https://refeds.org/assurance/IAP/low&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;https://aai.egi.eu/LoA#Substantial&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>],</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;eduperson_entitlement&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;urn:mace:egi.eu:group:demo.fedcloud.egi.eu:members:role=member#aai.egi.eu&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;urn:mace:egi.eu:group:demo.fedcloud.egi.eu:role=member#aai.egi.eu&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;urn:mace:egi.eu:group:demo.fedcloud.egi.eu:vm_operator:role=member#aai.egi.eu&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>],</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;email&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;jdoe@example.org&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;email_verified&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;exp&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1668616935</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;iat&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1668613335</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;iss&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;https://aai.egi.eu/auth/realms/egi&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;jti&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;fecaf906-8578-4155-9783-f2083900b93c&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;nonce&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;30ccf6777eb726aae4f71fc72684c07c&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;scope&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;openid eduperson_entitlement voperson_id profile email&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;session_state&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;dc0feb13-8a3d-4b91-86c6-039ee27503df&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;sid&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;dc0feb13-8a3d-4b91-86c6-039ee27503df&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;sub&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;1234567890123456789012345678901234567890123456789012345678901234@egi.eu&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;typ&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Bearer&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;voperson_id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;1234567890123456789012345678901234567890123456789012345678901234@egi.eu&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;voperson_verified_email&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;jdoe@example.org&#34;</span><span style=color:#000;font-weight:700>]</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=logout-endpoint>Logout Endpoint</h4><p>The EGI Check-in OpenID Provider supports user logout based on the
<a href=https://openid.net/specs/openid-connect-rpinitiated-1_0.html>OpenID Connect RP-Initiated Logout</a>.</p><p>The Logout Endpoint is normally obtained via the <code>end_session_endpoint</code> element
of Check-in&rsquo;s Provider Configuration (see <a href=#endpoints>Endpoints</a> table).
Parameters used in the logout request are detailed below:</p><ul><li><code>id_token_hint</code>: The ID Token previously issued by Check-in to your Relying
Party (RP) and provided to the Logout Endpoint as a hint regarding the end
user&rsquo;s current authenticated session with the client. It indicates the
identity of the end user that the RP is requesting Check-in to log out.
If the <code>id_token_hint</code> parameter is omitted, the user may be prompted to
confirm the logout.</li><li><code>client_id</code>: This parameter is used to specify the Client Identifier when
<code>post_logout_redirect_uri</code> is specified but <code>id_token_hint</code> is not.</li><li><code>post_logout_redirect_uri</code>: URI to which the RP is requesting that the end
user&rsquo;s browser be redirected after a logout has been performed. This URI
should use the HTTPS scheme and the value must have been previously registered
in the configuration of the Service in
<a href=https://aai.egi.eu/federation>EGI Federation Registry</a>. Note that you need
to include either the <code>client_id</code> or <code>id_token_hint</code> parameter in case the
<code>post_logout_redirect_uri</code> is included.</li></ul><p>You can use either HTTP GET or HTTP POST to send the logout request to the Logout Endpoint.</p><h5 id=example-request>Example Request</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#a40000>  </span><span style=color:#204a87;font-weight:700>HTTP</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#0000cf;font-weight:700>1.1</span> <span style=color:#0000cf;font-weight:700>302</span> <span style=color:#c00;font-weight:700>Found</span>
</span></span><span style=display:flex><span>  <span style=color:#000>Location: ${LOGOUT_ENDPOINT}?</span>
</span></span><span style=display:flex><span>    <span style=color:#000>id_token_hint=${ID_TOKEN}</span>
</span></span></code></pre></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>You can find the <code>LOGOUT_ENDPOINT</code> in
the <a href=#endpoints>Endpoints</a> table.</div><h5 id=example-request-with-redirection>Example Request with redirection</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#a40000>  </span><span style=color:#204a87;font-weight:700>HTTP</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#0000cf;font-weight:700>1.1</span> <span style=color:#0000cf;font-weight:700>302</span> <span style=color:#c00;font-weight:700>Found</span>
</span></span><span style=display:flex><span>  <span style=color:#000>Location: ${LOGOUT_ENDPOINT}?</span>
</span></span><span style=display:flex><span>    <span style=color:#000>post_logout_redirect_uri=${POST_LOGOUT_REDIRECT_URI}</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&amp;client_id=${CLIENT_ID}</span>
</span></span></code></pre></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>You can find the <code>LOGOUT_ENDPOINT</code> in
the <a href=#endpoints>Endpoints</a> table.</div><h3 id=claims-based-authorisation>Claims-based authorisation</h3><blockquote><p>As mentioned in <a href=#general-information>the General Information</a>, omitting
authorisation checks may lead to abuse of the service.</p></blockquote><p>EGI Check-in provides information about the authenticated user that may be used
by Service Providers in order to control user access to resources. This
information is provided by the EGI Check-in OpenID Provider in the form of
<a href=#claims>OIDC claims</a>. The table below lists the claims that are relevant for
user authorisation:</p><table><thead><tr><th>Description</th><th>OIDC Claim</th></tr></thead><tbody><tr><td><a href=#vogroup-membership-and-role-information>VO/group membership/roles of the authenticated user</a></td><td><code>eduperson_entitlement</code></td></tr><tr><td><a href=#capabilities>Capabilities</a></td><td><code>eduperson_entitlement</code></td></tr><tr><td><a href=#gocdb-roles>GOCDB roles</a></td><td><code>eduperson_entitlement</code></td></tr><tr><td><a href=#identity-assurance>Identity Assurance</a></td><td><code>eduperson_assurance</code></td></tr></tbody></table><h3 id=example-oidc-client-configurations>Example OIDC Client Configurations</h3><h4 id=keycloak-1>Keycloak</h4><p>If you are using Keycloak as an OIDC Relying Party, then you need to follow the
steps below in order to register EGI Check-in as an Identity Provider:</p><ol><li><p>Access the administrator console of your Keycloak instance and navigate to
&ldquo;Identity Providers&rdquo; and then select &ldquo;OpenID Connect v1.0&rdquo;</p><p><img src=oidc-examples-keycloak-idp.png alt="Keycloak IdP Page"></p></li><li><p>In the next page, complete the following fields:</p><ul><li>Alias: <code>egi-check-in-oidc</code></li><li>Display name: <code>EGI Check-in</code></li></ul><p><img src=oidc-examples-keycloak-add-oidc-idp-1.png alt="Add OIDC IdP"></p><p>Scroll down, and complete the rest options:</p><ul><li>Discovery endpoint:
<code>https://aai.egi.eu/auth/realms/egi/.well-known/openid-configuration</code></li><li>Client ID: <code>&lt;YOUR_CLIENT_ID></code></li><li>Client Secret: <code>&lt;YOUR_CLIENT_SECRET></code></li></ul><p><img src=oidc-examples-keycloak-add-oidc-idp-2.png alt="Add OIDC IdP"></p><p>And then click on the &ldquo;Add&rdquo; button.</p></li><li><p>After adding EGI Check-in IdP, scroll down to the &ldquo;OpenID Connect settings&rdquo;
section and expand the &ldquo;Advanced&rdquo; option and then add the scopes that the
Service needs. For example:</p><p>Scopes: <code>openid voperson_id email profile eduperson_entitlement</code></p><p><img src=oidc-examples-keycloak-oidc-idp-oidc.png alt="OpenID Connect Settings"></p></li><li><p>Then, scroll down to the &ldquo;Advanced settings&rdquo; section and enable the &ldquo;Trust
Email&rdquo; option and click on &ldquo;Save&rdquo; button.</p><p><img src=oidc-examples-keycloak-oidc-idp-advanced.png alt="Advanced Settings"></p></li><li><p>Next, you will need to add two mappers to store the <code>voperson_id</code> and the
<code>eduperson_entitlement</code> claims because Keycloak can map only the
<a href=https://openid.net/specs/openid-connect-core-1_0.html#StandardClaims>standard claims</a>.
Go to the &ldquo;Mappers&rdquo; tab and then click on &ldquo;Add Mapper&rdquo;.</p><p>For the <code>voperson_id</code> claim you will need to add the following options:</p><ul><li>Name: <code>voPersonID</code></li><li>Sync Mode Override: <code>import</code></li><li>Mapper Type: <code>Username Template Importer</code></li><li>Template: <code>${CLAIM.voperson_id}</code></li><li>Target: <code>LOCAL</code></li></ul><p><img src=oidc-examples-keycloak-oidc-voperson-id-mapper.png alt="voPersonID mapper"></p><p>And for the <code>eduperson_entitlement</code> claim:</p><ul><li>Name: <code>eduPersonEntitlement</code></li><li>Sync Mode Override: <code>Inherit</code></li><li>Mapper Type: <code>Attribute Importer</code></li><li>Claim: <code>eduperson_entitlement</code></li><li>User Attribute Name: <code>eduPersonEntitlement</code></li></ul><p><img src=oidc-examples-keycloak-oidc-eduperson-entitlement-mapper.png alt="eduPersonEntitlement mapper"></p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>For other
<a href=#user-attributes>attributes</a>, create a mapper similar to the
<code>eduPersonEntitlement</code> mapper.</div></li></ol><h4 id=simple-oidc-client-php>simple-oidc-client-php</h4><p>In this guide we will demonstrate how to install and configure a
<a href=https://github.com/rciam/simple-oidc-client-php>Simple OIDC Client</a>.</p><h5 id=install-simple-oidc-client-php>Install simple-oidc-client-php</h5><p>This guide assumes the Apache HTTP server has been installed and the document
root is <code>/var/www/html</code></p><p>Move to the apache document root and download and extract
<a href=https://github.com/rciam/simple-oidc-client-php/releases/download/v2.0.0/simple-oidc-client-php.tar.gz>simple-oidc-client-php.tar.gz</a>.</p><h5 id=configure-client>Configure Client</h5><p>Login to the <a href=https://aai.egi.eu/federation>EGI Federation Registry</a></p><p>Then create a new service or edit your existing service. In <code>General</code> tab fill
all the required fields. For <code>Integration Environment</code> select <code>Demo</code>. In
<code>Protocol Specific</code> tab select as Protocol the <code>OIDC Service</code> and then in the
<code>Redirect URI(s)</code> insert your simple-oidc-client-php URL (e.g.
<code>http://localhost/simple-oidc-client-php/refreshtoken.php</code>). This URL must link
to <code>refreshtoken.php</code> which is located in simple-oidc-client-php directory.
Next, in <code>Scope</code> select the scopes that your service needs. Then, submit the
form and self approve it. Finally you should get a pair of <code>Client ID</code> and
<code>Client Secret</code>.</p><h5 id=configure-simple-oidc-client-php>Configure simple-oidc-client-php</h5><p>Now that you have everything you need, you can configure your login settings. Go
to your terminal and open <code>config.php</code> with your favourite text editor.</p><p>Example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ vi simple-oidc-client-php/config.php
</span></span></code></pre></div><p>Let&rsquo;s go quickly through the settings:</p><ul><li><code>title</code> required, the title on the navigation bar</li><li><code>img</code> required, the source of the logo</li><li><code>scope_info</code> optional, a message that informs the user for the application
requirements</li><li><code>issuer</code> required, the base URL of our IdentityServer instance. This will
allow oidc-client to query the metadata endpoint so it can validate the tokens</li><li><code>client_id</code> required, the ID of the client we want to use when hitting the
Authorization Endpoint</li><li><code>client_secret</code> optional, a value the offers better security to the message
flow</li><li><code>pkceCodeChallengeMethod</code> optional, a string that defines the code challenge
method for PKCE. Choose between <code>plain</code> or <code>S256</code>.</li><li><code>redirect_url</code> required, the redirect URL where the client and the browser
agree to send and receive correspondingly the code</li><li><code>scopesDefine</code> required, defines the scopes the client supports</li><li><code>refresh_token_note</code> optional, info for the refresh token</li><li><code>access_token_note</code> optional, info for the access token</li><li><code>manage_token_note</code> optional, message the informs the user where can manage
his tokens</li><li><code>manageTokens</code> optional, URL of the manage tokens service</li><li><code>sessionName</code> required, define the name of the cookie session</li><li><code>sessionLifetime</code> required, define the duration of the session. This must be
equal to the validity time of the access token.</li></ul><p>You must change the followings options based on your Service configuration you
setup earlier:</p><ul><li><code>issuer</code></li><li><code>client_id</code></li><li><code>client_secret</code></li><li><code>redirect_url</code></li><li><code>scopesDefine</code></li><li><code>sessionName</code> (based on the installation path of the portal)</li></ul><p>An example configuration follows:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// index.php interface configuration
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>$title</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;Generate Tokens&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>$img</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;https://clickhelp.co/images/feeds/blog/2016.05/keys.jpg&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>$scope_info</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;This service requires the following permissions for your account:&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Client configuration
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>$issuer</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;https://aai-demo.egi.eu/auth/realms/egi&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>$client_id</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;CHANGE_ME&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>$client_secret</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;CHANGE_ME&#34;</span><span style=color:#000;font-weight:700>;</span>  <span style=color:#8f5902;font-style:italic>// comment if you are using PKCE
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// $pkceCodeChallengeMethod = &#34;S256&#34;;   // uncomment to use PKCE
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>$redirect_url</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;http://localhost/simple-oidc-client-php/refreshtoken.php&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// add scopes as keys and a friendly message of the scope as value
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>$scopesDefine</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>array</span><span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#39;openid&#39;</span> <span style=color:#ce5c00;font-weight:700>=&gt;</span> <span style=color:#4e9a06>&#39;log in using your identity&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#39;email&#39;</span> <span style=color:#ce5c00;font-weight:700>=&gt;</span> <span style=color:#4e9a06>&#39;read your email address&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#39;profile&#39;</span> <span style=color:#ce5c00;font-weight:700>=&gt;</span> <span style=color:#4e9a06>&#39;read your basic profile info&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// refreshtoken.php interface configuration
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>$refresh_token_note</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;NOTE: New refresh tokens expire in 12 months.&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>$access_token_note</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;NOTE: New access tokens expire in 1 hour.&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>$manage_token_note</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;You can manage your refresh tokens in the following link: &#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>$manageTokens</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>$issuer</span> <span style=color:#ce5c00;font-weight:700>.</span> <span style=color:#4e9a06>&#34;manage/user/services&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>$sessionName</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;simple-oidc-client-php&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>$sessionLifetime</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>60</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#0000cf;font-weight:700>60</span><span style=color:#000;font-weight:700>;</span>  <span style=color:#8f5902;font-style:italic>// must be equal to access token validation time in seconds
</span></span></span></code></pre></div><h3 id=client-migration-to-keycloak>Client Migration to Keycloak</h3><p>The migration guide below applies to OIDC clients registered in the
<strong>Development</strong>, <strong>Demo</strong> and <strong>Production</strong> environments of Check-in.</p><p><strong>Development and Demo</strong>: Beginning June 24, 2022, clients using the legacy
Check-in OIDC endpoints will no longer be supported.</p><p><strong>Production</strong>: Beginning October 21, 2022, clients using the legacy Check-in
OIDC endpoints will no longer be supported.</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>For OpenStack Services please read the
OpenStack specific migration guide on
<a href=../../cloud-compute/openstack/aai.md#client-migration-to-keycloak>Cloud Compute documentation</a>.</div><h4 id=how-to-migrate-your-service-to-keycloak-1>How to Migrate your Service to Keycloak</h4><p>All the clients that were registered in MITREid Connect have been moved to
Keycloak preserving all the options (Client ID, Client Secret, Redirect URIs
etc.), so you do not need to re-register your Service.</p><h5 id=new-endpoints>New Endpoints</h5><p>The first thing you need to do is to update the OIDC endpoints according to the
<a href=#endpoints>Endpoints</a> table. If the Application/Library supports Dynamic
Discovery, then you need to update on the <code>issuer</code>. Otherwise, you need to
update all the Endpoints separately.</p><h5 id=size-of-the-tokens>Size of the Tokens</h5><p>The size of the Access/Refresh Tokens that are issued by Keycloak is larger of
the respective Tokens created by MITREid Connect. For example, the size of an
Access Token is around 1400 characters, depending on the information that are
included in the payload of the JWT. So make sure that your OIDC implementation
can handle larger Tokens.</p><h5 id=logout>Logout</h5><p>The Redirect URI query parameter in the logout request has been changed from
<code>redirect</code> to <code>post_logout_redirect_uri</code> and must be URL encoded. Also, the
value of the <code>post_logout_redirect_uri</code> must be defined in the <strong>Valid Redirect
URIs</strong> of the Service configuration in the EGI Federation Registry.</p><h5 id=token-introspection>Token Introspection</h5><p>The Token Introspection is available to all the clients that are using any
authentication method (<code>client_secret_basic</code>, <code>client_secret_post</code>,
<code>client_secret_jwt</code> or <code>private_key_jwt</code>) (Confidential Clients) to the Token
Endpoint. Public Clients (clients that do not use any authentication method)
will not be able to get a successful response from the Introspection Endpoint.
Saying that, the &ldquo;Introspection&rdquo; option in the EGI Federation Registry will be
removed.</p><h5 id=pkce>PKCE</h5><p>If you are <strong>not</strong> using PKCE (Proof Key for Code Exchange), please make sure to
<strong>disable</strong> the &ldquo;PKCE Code Challenge Method&rdquo; in the Service configuration in
<a href=https://aai.egi.eu/federation>EGI Federation Registry</a>, otherwise you will get
the following HTTP response during the authentication flow:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#a40000>error=invalid_request&amp;error_description=Missing parameter: code_challenge_method
</span></span></span></code></pre></div><h5 id=device-code-grant>Device Code Grant</h5><p>If you are using a confidential client with the Device Code grant, please make
sure that the <code>client_secret</code> is present in the request to the Device Code
Endpoint either as HTTP Basic or HTTP POST parameter (see
<a href=#1-device-authorization-request>Device Authorization Request</a>).</p><h5 id=token-exchange-grant>Token Exchange Grant</h5><p>If you are using the Token Exchange grant, please make sure that the <code>audience</code>
(Optional) defines the logical name of the service that the token will be used
for; when specified, it must match the client ID of a client registered in
Check-in otherwise an <code>invalid_client</code> error is returned
(<code>"description": "audience not found"</code>)</p><h5 id=client-credentials-grant>Client Credentials Grant</h5><p>If you are using the Client Credentials grant, there is a minor change in the
responses from UserInfo and Introspection Endpoints. The <strong>Client ID</strong> of the
client is <strong>not</strong> released as the <code>sub</code> claim any more and has replaced with by
the <code>client_id</code> claim. The <code>sub</code> contains the identifier of the client which is
unique, non-reassignable and scoped <code>@egi.eu</code>.</p><h5 id=obtain-refresh-tokens>Obtain Refresh Tokens</h5><p>If you have obtained an Refresh Token from EGI Check-in Token Portal or
oidc-agent issued by the MITREid Connect instance, you will need to replace them
by creating new Refresh Tokens issued by Keycloak.</p><ul><li><p>If you have obtained Refresh Tokens using the EGI Check-in Token Portal,
please check the following table:</p><table><thead><tr><th>Environment</th><th>URL</th></tr></thead><tbody><tr><td>Production</td><td><a href=https://aai.egi.eu/token>https://aai.egi.eu/token</a></td></tr><tr><td>Demo</td><td><a href=https://aai-demo.egi.eu/token>https://aai-demo.egi.eu/token</a></td></tr><tr><td>Development</td><td><a href=https://aai-dev.egi.eu/token>https://aai-dev.egi.eu/token</a></td></tr></tbody></table></li><li><p>If you have obtained Refresh Tokens using the oidc-agent, please use the
following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ oidc-gen --pub --issuer &lt;ISSUER&gt; --scope ...
</span></span></code></pre></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>You can find the <code>ISSUER</code> in the
<a href=#endpoints>Endpoints</a> table.</div></li></ul><h4 id=common-issues>Common issues</h4><h5 id=error-messages-referring-to-missing-code_challenge-code_challenge_method-or-code_verifier-http-parameter>Error messages referring to missing <code>code_challenge</code>, <code>code_challenge_method</code> or <code>code_verifier</code> HTTP parameter</h5><p>If you get error messages containing the PKCE HTTP parameters, probably the PKCE
mode is enabled in your Service Configuration but the Application is not
performing the PKCE mode.</p><p>To solve this, you need to follow the steps below:</p><ol><li>Login to <a href=https://aai.egi.eu/federation>Federation Registry</a></li><li>Open your Service Configuration</li><li>Click on the “Protocol Specific” tab and scroll down to “Proof Key for Code
Exchange (PKCE) Code Challenge Method” and select “PKCE will not be used for
this service”</li><li>Click on “Submit” to apply the reconfiguration request</li></ol><h5 id=error-messages-referring-to-invalid_code>Error messages referring to <code>invalid_code</code></h5><p>If you try to perform the Authorization Code flow and you get an <code>invalid_code</code>
error message, probably the Application sends the Authorization Request to the
Authorization Endpoint of the Keycloak based EGI Check-in OP and then sends the
<code>code</code> to the Token Endpoint of the MITREid Connect based EGI Check-in OP or
vice versa.</p><p>To fix this you need to verify that you have updated all the OIDC Endpoints with
the Keycloak ones. You can find all the OIDC Endpoints of Keycloak in the
<a href=#endpoints>Endpoint</a> table.</p><h5 id=error-messages-referring-to-the-redirect_uri>Error messages referring to the <code>redirect_uri</code></h5><p>If you try to perform the Authorization Code flow and you get an
<code>invalid_redirect_uri</code> error, probably the <code>redirect_uri</code> in the Authorization
Request mismatches with the Allowed Redirect URIs in the Service Configuration.</p><p>To solve this, you need to follow the steps below:</p><ol><li>Login to <a href=https://aai.egi.eu/federation>Federation Registry</a></li><li>Open your Service Configuration</li><li>Click on the “Protocol Specific” tab and in the “Redirect URI(s)” edit the
URI.</li><li>Click on “Submit” to apply the reconfiguration request</li></ol><h5 id=userinfo-invalid_token-or-401-unauthorized-error-response>UserInfo <code>invalid_token</code> or <code>401 Unauthorized</code> error response</h5><p>If you are trying to make a request to the UserInfo Endpoint and the response
contains the <code>invalid_token</code> error message, probably you are using an invalid
Token or the UserInfo Endpoint is wrong.</p><p>To solve this, please make sure the that:</p><ol><li>You have obtained an Keycloak issued Access Token and you make a request to
the Keycloak based UserInfo Endpoint</li><li>You have added the Access Token to the Authorization header of the request</li></ol><h5 id=502-bad-gateway-error-after-redirecting-back-to-the-service><code>502 Bad Gateway</code> error after redirecting back to the Service</h5><p>If you are using NGINX as a Reverse Proxy, and you are getting the following
error message in the logs:</p><blockquote><p>upstream sent too big header while reading response header from upstream</p></blockquote><p>Then you need to increase the size of the buffer by adding the following options
in the vhost configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#204a87;font-weight:700>proxy_buffers</span> <span style=color:#0000cf;font-weight:700>4</span> <span style=color:#0000cf;font-weight:700>256k</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>proxy_buffer_size</span> <span style=color:#0000cf;font-weight:700>128k</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>proxy_busy_buffers_size</span> <span style=color:#0000cf;font-weight:700>256k</span><span style=color:#000;font-weight:700>;</span>
</span></span></code></pre></div><h2 id=integrating-science-gateways-with-rcauth-for-obtaining-proxy-certificates>Integrating Science Gateways with RCauth for obtaining (proxy) certificates</h2><p>In order for Science Gateways (VO portals) to obtain RFC proxy certificates
derived from <strong>personal</strong> end-entity certificates, an EGI Science Gateway can
make use of the IGTF-approved IOTA-type RCauth.eu online CA. The actual
integration goes via an intermediary service, called a Master Portal. EGI is
running two Master Portal instances, one development, one production instance.</p><ul class="nav nav-tabs" id=tabs-28 role=tablist><li class=nav-item><a class="nav-link active" id=tabs-28-0-tab data-toggle=tab href=#tabs-28-0 role=tab aria-controls=tabs-28-0 aria-selected=true>Production</a></li><li class=nav-item><a class=nav-link id=tabs-28-1-tab data-toggle=tab href=#tabs-28-1 role=tab aria-controls=tabs-28-1 aria-selected=false>Development</a></li></ul><div class=tabx-content id=tabs-28-content><div class="tab-pane show active" id=tabs-28-0 role=tabpanel aria-labelled-by=tabs-28-0-tab><table><thead><tr><th>Endpoint</th><th>Production environment</th></tr></thead><tbody><tr><td>Provider configuration</td><td><a href=https://aai.egi.eu/mp-oa2-server/.well-known/openid-configuration>https://aai.egi.eu/mp-oa2-server/.well-known/openid-configuration</a></td></tr><tr><td>Client registration</td><td><a href=https://aai.egi.eu/mp-oa2-server/register>https://aai.egi.eu/mp-oa2-server/register</a></td></tr><tr><td>Authorization</td><td><a href=https://aai.egi.eu/mp-oa2-server/authorize>https://aai.egi.eu/mp-oa2-server/authorize</a></td></tr><tr><td>Token</td><td><a href=https://aai.egi.eu/mp-oa2-server/token>https://aai.egi.eu/mp-oa2-server/token</a></td></tr><tr><td>JSON Web Key Sets(JWKS)</td><td><a href=https://aai.egi.eu/mp-oa2-server/certs>https://aai.egi.eu/mp-oa2-server/certs</a></td></tr><tr><td>UserInfo</td><td><a href=https://aai.egi.eu/mp-oa2-server/userinfo>https://aai.egi.eu/mp-oa2-server/userinfo</a></td></tr></tbody></table></div><div class=tab-pane id=tabs-28-1 role=tabpanel aria-labelled-by=tabs-28-1-tab><table><thead><tr><th>Endpoint</th><th>Development environment</th></tr></thead><tbody><tr><td>Provider configuration</td><td><a href=https://masterportal-pilot.aai.egi.eu/mp-oa2-server/.well-known/openid-configuration>https://masterportal-pilot.aai.egi.eu/mp-oa2-server/.well-known/openid-configuration</a></td></tr><tr><td>Client registration</td><td><a href=https://masterportal-pilot.aai.egi.eu/mp-oa2-server/register>https://masterportal-pilot.aai.egi.eu/mp-oa2-server/register</a></td></tr><tr><td>Authorization</td><td><a href=https://masterportal-pilot.aai.egi.eu/mp-oa2-server/authorize>https://masterportal-pilot.aai.egi.eu/mp-oa2-server/authorize</a></td></tr><tr><td>Token</td><td><a href=https://masterportal-pilot.aai.egi.eu/mp-oa2-server/token>https://masterportal-pilot.aai.egi.eu/mp-oa2-server/token</a></td></tr><tr><td>JSON Web Key Sets(JWKS)</td><td><a href=https://masterportal-pilot.aai.egi.eu/mp-oa2-server/certs>https://masterportal-pilot.aai.egi.eu/mp-oa2-server/certs</a></td></tr><tr><td>UserInfo</td><td><a href=https://masterportal-pilot.aai.egi.eu/mp-oa2-server/userinfo>https://masterportal-pilot.aai.egi.eu/mp-oa2-server/userinfo</a></td></tr></tbody></table></div></div><h3 id=registering-a-client-at-the-master-portal>Registering a client at the Master Portal</h3><p>In order to register a new client for your VO portal go to:</p><ul><li>EGI Development instance:
<a href=https://masterportal-pilot.aai.egi.eu/mp-oa2-server/register>https://masterportal-pilot.aai.egi.eu/mp-oa2-server/register</a></li><li>EGI Production instance: <a href=https://aai.egi.eu/mp-oa2-server/register>https://aai.egi.eu/mp-oa2-server/register</a></li></ul><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>Make sure to store the <code>client_id</code> and
<code>client_secret</code> in a secure place</div><p>In order to get the client approved, send an email to the administrator of the
EGI Master Portal using <code>checkin-support</code> <code>&lt;AT></code> <code>mailman.egi.eu</code>.</p><h4 id=detailed-information>Detailed information</h4><p>For further and detailed instructions on the integration flow, see the generic
<a href=https://wiki.nikhef.nl/grid/RCauth.eu_and_MasterPortal_VOPortal_integration_guide>RCAuth.eu MasterPortal VOPortal integration guide</a></p><h4 id=ssh-key-authentication-for-proxy-retrieval>SSH key authentication for proxy retrieval</h4><p>The EGI MasterPortal also allows users to authenticate using <em>SSH key pair</em>, in
order to retrieve proxy certificates from the MasterPortal. Users need to first
upload the public key via a self-service portal, <a href=https://aai.egi.eu/sshkeys/>https://aai.egi.eu/sshkeys/</a>.
About once a week they need to follow a web-flow to ensure a long-lived proxy
certificate is present in MasterPortal, e.g. by going to
<a href=https://aai.egi.eu/vo-portal/>https://aai.egi.eu/vo-portal/</a>. They can then obtain a proxy certificate by
doing</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ssh proxy@ssh.aai.egi.eu
</span></span></code></pre></div><p>and storing the output in <code>/tmp/x509up_u$(id -u)</code></p><p>Generic information for users on how to do this can be found at
<a href=https://wiki.nikhef.nl/grid/RCauth.eu_and_MasterPortal_SSH_Key_Portal>Instructions for end users on how to use the SSH key authN for proxy retrieval</a>.
Alternatively VO portals could implement such functionality themselves by using
the API described at the
<a href=https://wiki.nikhef.nl/grid/Master_Portal_sshkey_endpoint>Master Portal sshkey endpoint description</a>.</p><h2 id=user-attributes>User attributes</h2><p>This section defines the attributes that can be made available to services
connected to Check-in.</p><h3 id=1-community-user-identifier>1. Community User Identifier</h3><table><thead><tr><th style=text-align:right>attribute name</th><th style=text-align:left>Community User Identifier</th></tr></thead><tbody><tr><td style=text-align:right><strong>description</strong></td><td style=text-align:left>The User’s Community Identifier is a globally unique, opaque, persistent and non-reassignable identifier identifying the user. For users whose community identity is managed by Check-in, this identifier is of the form <code>&lt;uniqueID>@egi.eu</code>. The <code>&lt;uniqueID></code> portion is an opaque identifier issued by Check-in</td></tr><tr><td style=text-align:right><strong>SAML Attribute(s)</strong></td><td style=text-align:left><code>urn:oid:1.3.6.1.4.1.25178.4.1.6</code> (voPersonID)</td></tr><tr><td style=text-align:right><strong>OIDC scope</strong></td><td style=text-align:left><ul><li><code>voperson_id</code></li><li><code>aarc</code></li></ul></td></tr><tr><td style=text-align:right><strong>OIDC claim(s)</strong></td><td style=text-align:left><code>voperson_id</code></td></tr><tr><td style=text-align:right><strong>OIDC claim location</strong></td><td style=text-align:left><ul><li>ID token</li><li>UserInfo Endpoint</li><li>Introspection Endpoint</li></ul></td></tr><tr><td style=text-align:right><strong>origin</strong></td><td style=text-align:left>The Community User Identifier is assigned by Check-in or an external AAI service managing the community identity of the user</td></tr><tr><td style=text-align:right><strong>changes</strong></td><td style=text-align:left>No</td></tr><tr><td style=text-align:right><strong>multiplicity</strong></td><td style=text-align:left>No</td></tr><tr><td style=text-align:right><strong>availability</strong></td><td style=text-align:left>Always</td></tr><tr><td style=text-align:right><strong>example</strong></td><td style=text-align:left><code>ef72285491ffe53c39b75bdcef46689f5d26ddfa00312365cc4fb5ce97e9ca87@egi.eu</code></td></tr><tr><td style=text-align:right><strong>notes</strong></td><td style=text-align:left>Use <strong>Community User Identifier</strong> within your application as the unique-identifier key for the user. Obtaining the Community User Identifier from the <code>sub</code> claim using the <code>openid</code> scope for OIDC Relying Parties or from <code>eduPersonUniqueId</code> for SAML Service Providers has been deprecated. OIDC RPs should request either the <code>voperson_id</code> or <code>aarc</code> scope to obtain the Community User Identifier. SAML PRs should request the <code>voPersonID</code> attribute to obtain the Community User Identifier.</td></tr><tr><td style=text-align:right><strong>status</strong></td><td style=text-align:left>Stable</td></tr></tbody></table><h3 id=2-display-name>2. Display Name</h3><table><thead><tr><th style=text-align:right>attribute name</th><th style=text-align:left>Display Name</th></tr></thead><tbody><tr><td style=text-align:right><strong>description</strong></td><td style=text-align:left>The user&rsquo;s full name, in a displayable form</td></tr><tr><td style=text-align:right><strong>SAML Attribute(s)</strong></td><td style=text-align:left><code>urn:oid:2.16.840.1.113730.3.1.241</code> (displayName)</td></tr><tr><td style=text-align:right><strong>OIDC scope</strong></td><td style=text-align:left><ul><li><code>profile</code></li><li><code>aarc</code></li></ul></td></tr><tr><td style=text-align:right><strong>OIDC claim(s)</strong></td><td style=text-align:left><code>name</code></td></tr><tr><td style=text-align:right><strong>OIDC claim location</strong></td><td style=text-align:left>UserInfo Endpoint</td></tr><tr><td style=text-align:right><strong>origin</strong></td><td style=text-align:left>Provided by user&rsquo;s Identity Provider</td></tr><tr><td style=text-align:right><strong>changes</strong></td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:right><strong>multiplicity</strong></td><td style=text-align:left>Single-valued</td></tr><tr><td style=text-align:right><strong>availability</strong></td><td style=text-align:left>Always</td></tr><tr><td style=text-align:right><strong>example</strong></td><td style=text-align:left><code>John Doe</code></td></tr><tr><td style=text-align:right><strong>notes</strong></td><td style=text-align:left>-</td></tr><tr><td style=text-align:right><strong>status</strong></td><td style=text-align:left>Stable</td></tr></tbody></table><h3 id=3-given-name>3. Given Name</h3><table><thead><tr><th style=text-align:right>attribute name</th><th style=text-align:left>Given Name</th></tr></thead><tbody><tr><td style=text-align:right><strong>description</strong></td><td style=text-align:left>The user&rsquo;s first name</td></tr><tr><td style=text-align:right><strong>SAML Attribute(s)</strong></td><td style=text-align:left><code>urn:oid:2.5.4.42</code> (givenName)</td></tr><tr><td style=text-align:right><strong>OIDC scope</strong></td><td style=text-align:left><ul><li><code>profile</code></li><li><code>aarc</code></li></ul></td></tr><tr><td style=text-align:right><strong>OIDC claim(s)</strong></td><td style=text-align:left><code>given_name</code></td></tr><tr><td style=text-align:right><strong>OIDC claim location</strong></td><td style=text-align:left>UserInfo Endpoint</td></tr><tr><td style=text-align:right><strong>origin</strong></td><td style=text-align:left>Provided by user&rsquo;s Identity Provider</td></tr><tr><td style=text-align:right><strong>changes</strong></td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:right><strong>multiplicity</strong></td><td style=text-align:left>Single-valued</td></tr><tr><td style=text-align:right><strong>availability</strong></td><td style=text-align:left>Always</td></tr><tr><td style=text-align:right><strong>example</strong></td><td style=text-align:left><code>John</code></td></tr><tr><td style=text-align:right><strong>notes</strong></td><td style=text-align:left>-</td></tr><tr><td style=text-align:right><strong>status</strong></td><td style=text-align:left>Stable</td></tr></tbody></table><h3 id=4-family-name>4. Family Name</h3><table><thead><tr><th style=text-align:right>attribute name</th><th style=text-align:left>Family Name</th></tr></thead><tbody><tr><td style=text-align:right><strong>description</strong></td><td style=text-align:left>The user&rsquo;s last name</td></tr><tr><td style=text-align:right><strong>SAML Attribute(s)</strong></td><td style=text-align:left><code>urn:oid:2.5.4.4</code> (sn)</td></tr><tr><td style=text-align:right><strong>OIDC scope</strong></td><td style=text-align:left><ul><li><code>profile</code></li><li><code>aarc</code></li></ul></td></tr><tr><td style=text-align:right><strong>OIDC claim(s)</strong></td><td style=text-align:left><code>family_name</code></td></tr><tr><td style=text-align:right><strong>OIDC claim location</strong></td><td style=text-align:left>UserInfo Endpoint</td></tr><tr><td style=text-align:right><strong>origin</strong></td><td style=text-align:left>Provided by user&rsquo;s Identity Provider</td></tr><tr><td style=text-align:right><strong>changes</strong></td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:right><strong>multiplicity</strong></td><td style=text-align:left>Single-valued</td></tr><tr><td style=text-align:right><strong>availability</strong></td><td style=text-align:left>Always</td></tr><tr><td style=text-align:right><strong>example</strong></td><td style=text-align:left><code>Doe</code></td></tr><tr><td style=text-align:right><strong>notes</strong></td><td style=text-align:left>-</td></tr><tr><td style=text-align:right><strong>status</strong></td><td style=text-align:left>Stable</td></tr></tbody></table><h3 id=5-username>5. Username</h3><table><thead><tr><th style=text-align:right>attribute name</th><th style=text-align:left>Username</th></tr></thead><tbody><tr><td style=text-align:right><strong>description</strong></td><td style=text-align:left>The username by which the user wishes to be referred to</td></tr><tr><td style=text-align:right><strong>SAML Attribute(s)</strong></td><td style=text-align:left><code>urn:oid:0.9.2342.19200300.100.1.1</code> (uid)</td></tr><tr><td style=text-align:right><strong>OIDC scope</strong></td><td style=text-align:left><ul><li><code>profile</code></li><li><code>aarc</code></li></ul></td></tr><tr><td style=text-align:right><strong>OIDC claim(s)</strong></td><td style=text-align:left><code>preferred_username</code></td></tr><tr><td style=text-align:right><strong>OIDC claim location</strong></td><td style=text-align:left><ul><li>ID token</li><li>UserInfo Endpoint</li><li>Introspection Endpoint</li></ul></td></tr><tr><td style=text-align:right><strong>origin</strong></td><td style=text-align:left>Check-in assigns this attribute on user registration</td></tr><tr><td style=text-align:right><strong>changes</strong></td><td style=text-align:left>No</td></tr><tr><td style=text-align:right><strong>multiplicity</strong></td><td style=text-align:left>Single-valued</td></tr><tr><td style=text-align:right><strong>availability</strong></td><td style=text-align:left>Always</td></tr><tr><td style=text-align:right><strong>example</strong></td><td style=text-align:left><code>jdoe</code></td></tr><tr><td style=text-align:right><strong>notes</strong></td><td style=text-align:left>The Service Provider <strong>MUST NOT</strong> rely upon this value being unique</td></tr><tr><td style=text-align:right><strong>status</strong></td><td style=text-align:left>Stable</td></tr></tbody></table><h3 id=6-email-address>6. Email Address</h3><table><thead><tr><th style=text-align:right>attribute name</th><th style=text-align:left>Email Address</th></tr></thead><tbody><tr><td style=text-align:right><strong>description</strong></td><td style=text-align:left>The user&rsquo;s email address</td></tr><tr><td style=text-align:right><strong>SAML Attribute(s)</strong></td><td style=text-align:left><code>urn:oid:0.9.2342.19200300.100.1.3</code> (mail)</td></tr><tr><td style=text-align:right><strong>OIDC scope</strong></td><td style=text-align:left><ul><li><code>email</code></li><li><code>aarc</code></li></ul></td></tr><tr><td style=text-align:right><strong>OIDC claim(s)</strong></td><td style=text-align:left><code>email</code></td></tr><tr><td style=text-align:right><strong>OIDC claim location</strong></td><td style=text-align:left><ul><li>UserInfo Endpoint</li><li>Introspection Endpoint</li></ul></td></tr><tr><td style=text-align:right><strong>origin</strong></td><td style=text-align:left>Provided by user&rsquo;s Identity Provider</td></tr><tr><td style=text-align:right><strong>changes</strong></td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:right><strong>multiplicity</strong></td><td style=text-align:left>Single-valued</td></tr><tr><td style=text-align:right><strong>availability</strong></td><td style=text-align:left>Always</td></tr><tr><td style=text-align:right><strong>example</strong></td><td style=text-align:left><code>john.doe@example.org</code></td></tr><tr><td style=text-align:right><strong>notes</strong></td><td style=text-align:left>This <strong>MAY NOT</strong> be unique and is <strong>NOT</strong> suitable for use as a primary key</td></tr><tr><td style=text-align:right><strong>status</strong></td><td style=text-align:left>Stable</td></tr></tbody></table><h3 id=7-verified-email-flag>7. Verified email flag</h3><table><thead><tr><th style=text-align:right>attribute name</th><th style=text-align:left>Verified email flag</th></tr></thead><tbody><tr><td style=text-align:right><strong>description</strong></td><td style=text-align:left>True if the user&rsquo;s email address has been verified; otherwise false</td></tr><tr><td style=text-align:right><strong>SAML Attribute(s)</strong></td><td style=text-align:left>See <a href=#8-verified-email-list>Verified email list</a></td></tr><tr><td style=text-align:right><strong>OIDC scope</strong></td><td style=text-align:left><ul><li><code>email</code></li><li><code>aarc</code></li></ul></td></tr><tr><td style=text-align:right><strong>OIDC claim(s)</strong></td><td style=text-align:left><code>email_verified</code></td></tr><tr><td style=text-align:right><strong>OIDC claim location</strong></td><td style=text-align:left><ul><li>UserInfo Endpoint</li><li>Introspection Endpoint</li></ul></td></tr><tr><td style=text-align:right><strong>origin</strong></td><td style=text-align:left>Check-in assigns this attribute on user registration</td></tr><tr><td style=text-align:right><strong>changes</strong></td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:right><strong>multiplicity</strong></td><td style=text-align:left>Single-valued</td></tr><tr><td style=text-align:right><strong>availability</strong></td><td style=text-align:left>Always</td></tr><tr><td style=text-align:right><strong>example</strong></td><td style=text-align:left><code>true</code></td></tr><tr><td style=text-align:right><strong>notes</strong></td><td style=text-align:left>This claim is available only in OpenID Connect</td></tr><tr><td style=text-align:right><strong>status</strong></td><td style=text-align:left>Stable</td></tr></tbody></table><h3 id=8-verified-email-list>8. Verified email list</h3><table><thead><tr><th style=text-align:right>attribute name</th><th style=text-align:left>Verified email list</th></tr></thead><tbody><tr><td style=text-align:right><strong>description</strong></td><td style=text-align:left>A list of user&rsquo;s email addresses that have been verified</td></tr><tr><td style=text-align:right><strong>SAML Attribute(s)</strong></td><td style=text-align:left><code>urn:oid:1.3.6.1.4.1.25178.4.1.14</code> (voPersonVerifiedEmail)</td></tr><tr><td style=text-align:right><strong>OIDC scope</strong></td><td style=text-align:left><ul><li><code>email</code></li><li><code>aarc</code></li></ul></td></tr><tr><td style=text-align:right><strong>OIDC claim(s)</strong></td><td style=text-align:left><code>voperson_verified_email</code></td></tr><tr><td style=text-align:right><strong>OIDC claim location</strong></td><td style=text-align:left><ul><li>UserInfo Endpoint</li><li>Introspection Endpoint</li></ul></td></tr><tr><td style=text-align:right><strong>origin</strong></td><td style=text-align:left>Check-in or the user&rsquo;s Identity Provider</td></tr><tr><td style=text-align:right><strong>changes</strong></td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:right><strong>multiplicity</strong></td><td style=text-align:left>Multi-valued</td></tr><tr><td style=text-align:right><strong>availability</strong></td><td style=text-align:left>Not always</td></tr><tr><td style=text-align:right><strong>example</strong></td><td style=text-align:left><ul><li><code>john.doe@example.org</code></li><li><code>jdoe@example.com</code></li></ul></td></tr><tr><td style=text-align:right><strong>notes</strong></td><td style=text-align:left>-</td></tr><tr><td style=text-align:right><strong>status</strong></td><td style=text-align:left>Experimental</td></tr></tbody></table><h3 id=9-affiliation>9. Affiliation</h3><table><thead><tr><th style=text-align:right>attribute name</th><th style=text-align:left>Affiliation</th></tr></thead><tbody><tr><td style=text-align:right><strong>description</strong></td><td style=text-align:left>The user&rsquo;s affiliation within a particular security domain (scope)</td></tr><tr><td style=text-align:right><strong>SAML Attribute(s)</strong></td><td style=text-align:left><code>urn:oid:1.3.6.1.4.1.25178.4.1.11</code> (voPersonExternalAffiliation)</td></tr><tr><td style=text-align:right><strong>OIDC scope</strong></td><td style=text-align:left><code>voperson_external_affiliation</code></td></tr><tr><td style=text-align:right><strong>OIDC claim(s)</strong></td><td style=text-align:left><code>voperson_external_affiliation</code></td></tr><tr><td style=text-align:right><strong>OIDC claim location</strong></td><td style=text-align:left><ul><li>UserInfo Endpoint</li><li>Introspection Endpoint</li></ul></td></tr><tr><td style=text-align:right><strong>origin</strong></td><td style=text-align:left>When available, this information originates from the user&rsquo;s authenticating Identity Provider</td></tr><tr><td style=text-align:right><strong>changes</strong></td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:right><strong>multiplicity</strong></td><td style=text-align:left>Multi-valued</td></tr><tr><td style=text-align:right><strong>availability</strong></td><td style=text-align:left>Not always</td></tr><tr><td style=text-align:right><strong>example</strong></td><td style=text-align:left><ul><li><code>member@example.org</code></li><li><code>faculty@example.org</code></li></ul></td></tr><tr><td style=text-align:right><strong>notes</strong></td><td style=text-align:left>Service Providers are encouraged to validate the scope of this attribute</td></tr><tr><td style=text-align:right><strong>status</strong></td><td style=text-align:left>Stable</td></tr></tbody></table><h3 id=10-groups>10. Groups</h3><table><thead><tr><th style=text-align:right>attribute name</th><th style=text-align:left>Groups</th></tr></thead><tbody><tr><td style=text-align:right><strong>description</strong></td><td style=text-align:left>The user&rsquo;s group/VO membership/role information expressed as entitlements</td></tr><tr><td style=text-align:right><strong>SAML Attribute(s)</strong></td><td style=text-align:left><code>urn:oid:1.3.6.1.4.1.5923.1.1.1.7</code> (eduPersonEntitlement)</td></tr><tr><td style=text-align:right><strong>OIDC scope</strong></td><td style=text-align:left><code>eduperson_entitlement</code></td></tr><tr><td style=text-align:right><strong>OIDC claim(s)</strong></td><td style=text-align:left><code>eduperson_entitlement</code></td></tr><tr><td style=text-align:right><strong>OIDC claim location</strong></td><td style=text-align:left><ul><li>UserInfo Endpoint</li><li>Introspection Endpoint</li></ul></td></tr><tr><td style=text-align:right><strong>origin</strong></td><td style=text-align:left>Group memberships are managed by group administrators</td></tr><tr><td style=text-align:right><strong>changes</strong></td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:right><strong>multiplicity</strong></td><td style=text-align:left>Multi-valued</td></tr><tr><td style=text-align:right><strong>availability</strong></td><td style=text-align:left>Not always</td></tr><tr><td style=text-align:right><strong>example</strong></td><td style=text-align:left><ul><li><code>urn:mace:egi.eu:aai.egi.eu:member@fedcloud.egi.eu</code></li><li><code>urn:mace:egi.eu:aai.egi.eu:vm_operator@fedcloud.egi.eu</code></li></ul></td></tr><tr><td style=text-align:right><strong>notes</strong></td><td style=text-align:left>-</td></tr><tr><td style=text-align:right><strong>status</strong></td><td style=text-align:left>Stable</td></tr></tbody></table><h3 id=11-capabilities>11. Capabilities</h3><table><thead><tr><th style=text-align:right>attribute name</th><th style=text-align:left>Capabilities</th></tr></thead><tbody><tr><td style=text-align:right><strong>description</strong></td><td style=text-align:left>This attribute describes the resource or child-resource a user is allowed to access, optionally specifying certain actions the user is entitled to perform, as described in <a href=https://aarc-community.org/guidelines/aarc-g027/>AARC-G027</a></td></tr><tr><td style=text-align:right><strong>SAML Attribute(s)</strong></td><td style=text-align:left><code>urn:oid:1.3.6.1.4.1.5923.1.1.1.7</code> (eduPersonEntitlement)</td></tr><tr><td style=text-align:right><strong>OIDC scope</strong></td><td style=text-align:left><code>eduperson_entitlement</code></td></tr><tr><td style=text-align:right><strong>OIDC claim(s)</strong></td><td style=text-align:left><code>eduperson_entitlement</code></td></tr><tr><td style=text-align:right><strong>OIDC claim location</strong></td><td style=text-align:left><ul><li>UserInfo Endpoint</li><li>Introspection Endpoint</li></ul></td></tr><tr><td style=text-align:right><strong>origin</strong></td><td style=text-align:left>Capabilities are managed by Check-in</td></tr><tr><td style=text-align:right><strong>changes</strong></td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:right><strong>multiplicity</strong></td><td style=text-align:left>Multi-valued</td></tr><tr><td style=text-align:right><strong>availability</strong></td><td style=text-align:left>Not always</td></tr><tr><td style=text-align:right><strong>example</strong></td><td style=text-align:left><ul><li><code>urn:mace:egi.eu:res:rcauth#aai.egi.eu</code></li><li><code>urn:mace:egi.eu:res:gocdb#aai.egi.eu</code></li></ul></td></tr><tr><td style=text-align:right><strong>notes</strong></td><td style=text-align:left>-</td></tr><tr><td style=text-align:right><strong>status</strong></td><td style=text-align:left>Stable</td></tr></tbody></table><h3 id=12-gocdb-roles>12. GOCDB Roles</h3><table><thead><tr><th style=text-align:right>attribute name</th><th style=text-align:left>GOCDB Roles</th></tr></thead><tbody><tr><td style=text-align:right><strong>description</strong></td><td style=text-align:left>The user&rsquo;s GOCDB role information expressed as entitlements</td></tr><tr><td style=text-align:right><strong>SAML Attribute(s)</strong></td><td style=text-align:left><code>urn:oid:1.3.6.1.4.1.5923.1.1.1.7</code> (eduPersonEntitlement)</td></tr><tr><td style=text-align:right><strong>OIDC scope</strong></td><td style=text-align:left><code>eduperson_entitlement</code></td></tr><tr><td style=text-align:right><strong>OIDC claim(s)</strong></td><td style=text-align:left><code>eduperson_entitlement</code></td></tr><tr><td style=text-align:right><strong>OIDC claim location</strong></td><td style=text-align:left><ul><li>UserInfo Endpoint</li><li>Introspection Endpoint</li></ul></td></tr><tr><td style=text-align:right><strong>origin</strong></td><td style=text-align:left>The roles are managed in GOCDB</td></tr><tr><td style=text-align:right><strong>changes</strong></td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:right><strong>multiplicity</strong></td><td style=text-align:left>Multi-valued</td></tr><tr><td style=text-align:right><strong>availability</strong></td><td style=text-align:left>Not always</td></tr><tr><td style=text-align:right><strong>example</strong></td><td style=text-align:left><ul><li><code>urn:mace:egi.eu:goc.egi.eu:100453G0:GRIDOPS-CheckIn:Site+Administrator@egi.eu</code></li><li><code>urn:mace:egi.eu:goc.egi.eu:92503G08:GRIDOPS-MON:Site+Operations+Manager@egi.eu</code></li></ul></td></tr><tr><td style=text-align:right><strong>notes</strong></td><td style=text-align:left>-</td></tr><tr><td style=text-align:right><strong>status</strong></td><td style=text-align:left>Stable</td></tr></tbody></table><h3 id=13-assurance>13. Assurance</h3><table><thead><tr><th style=text-align:right>attribute name</th><th style=text-align:left>Assurance</th></tr></thead><tbody><tr><td style=text-align:right><strong>description</strong></td><td style=text-align:left>Assurance of the identity of the user, following <a href=https://refeds.org/assurance>REFEDS Assurance Framework (RAF)</a> and the <a href=https://docs.egi.eu/providers/check-in/sp/#level-of-assurance>EGI AAI Assurance Profiles</a>. The following RAF values are qualified and automatically set for all Community identities:<ul><li>$PREFIX$</li><li>$PREFIX$/ID/unique</li><li>$PREFIX$/ID/eppn-unique-no-reassign</li><li>$PREFIX$/IAP/low</li><li>$PREFIX$/ATP/ePA-1m</li><li>$PREFIX$/ATP/ePA-1d</li></ul>Following RAF values are set if the currently used authentication provider asserts (or otherwise qualifies to) them:</br><ul><li>$PREFIX$/IAP/medium</li><li>$PREFIX$/IAP/high</li></ul>The following compound profiles are asserted if the user qualifies to them</br><ul><li>$PREFIX$/profile/cappuccino</li><li>$PREFIX$/profile/espresso</li></ul></td></tr><tr><td style=text-align:right><strong>SAML Attribute(s)</strong></td><td style=text-align:left><code>urn:oid:1.3.6.1.4.1.5923.1.1.1.11</code> (eduPersonAssurance)</td></tr><tr><td style=text-align:right><strong>OIDC scope</strong></td><td style=text-align:left><code>openid</code></td></tr><tr><td style=text-align:right><strong>OIDC claim(s)</strong></td><td style=text-align:left><code>eduperson_assurance</code></td></tr><tr><td style=text-align:right><strong>OIDC claim location</strong></td><td style=text-align:left><ul><li>UserInfo Endpoint</li><li>Introspection Endpoint</li></ul></td></tr><tr><td style=text-align:right><strong>origin</strong></td><td style=text-align:left>Check-in assigns this attribute on user registration</td></tr><tr><td style=text-align:right><strong>changes</strong></td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:right><strong>multiplicity</strong></td><td style=text-align:left>Multi-valued</td></tr><tr><td style=text-align:right><strong>availability</strong></td><td style=text-align:left>Always</td></tr><tr><td style=text-align:right><strong>example</strong></td><td style=text-align:left><ul><li><code>https://aai.egi.eu/LoA#Low</code></li><li><code>https://refeds.org/assurance/IAP/low</code></li></ul></td></tr><tr><td style=text-align:right><strong>notes</strong></td><td style=text-align:left>-</td></tr><tr><td style=text-align:right><strong>status</strong></td><td style=text-align:left>Stable</td></tr></tbody></table><h3 id=14-certentitlement>14. CertEntitlement</h3><table><thead><tr><th style=text-align:right>attribute name</th><th style=text-align:left>CertEntitlement</th></tr></thead><tbody><tr><td style=text-align:right><strong>description</strong></td><td style=text-align:left>Provides information about the user&rsquo;s certificate subject(s) and the associated VO(s)</td></tr><tr><td style=text-align:right><strong>SAML Attribute(s)</strong></td><td style=text-align:left><strong>Not available</strong></td></tr><tr><td style=text-align:right><strong>OIDC scope</strong></td><td style=text-align:left><code>cert_entitlement</code></td></tr><tr><td style=text-align:right><strong>OIDC claim(s)</strong></td><td style=text-align:left><code>cert_entitlement</code></td></tr><tr><td style=text-align:right><strong>OIDC claim location</strong></td><td style=text-align:left><ul><li>UserInfo Endpoint</li><li>Introspection Endpoint</li></ul></td></tr><tr><td style=text-align:right><strong>origin</strong></td><td style=text-align:left>VO/group management tools integrated with Check-in</td></tr><tr><td style=text-align:right><strong>changes</strong></td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:right><strong>multiplicity</strong></td><td style=text-align:left>Multi-valued</td></tr><tr><td style=text-align:right><strong>availability</strong></td><td style=text-align:left>Not always</td></tr><tr><td style=text-align:right><strong>example</strong></td><td style=text-align:left><code>[{"cert_subject_dn": "/C=GR/O=HellasGrid/...","cert_iss": "/C=GR/O=HellasGrid/...","eduperson_entitlement": "urn:mace:egi.eu:group:checkin-integration:role=VO-Admin#aai.egi.eu"}]</code></td></tr><tr><td style=text-align:right><strong>notes</strong></td><td style=text-align:left>This is available only for DIRAC</td></tr><tr><td style=text-align:right><strong>status</strong></td><td style=text-align:left>Stable</td></tr></tbody></table><h3 id=15-ssh-public-key>15. SSH Public Key</h3><table><thead><tr><th style=text-align:right>attribute name</th><th style=text-align:left>SSH Public Key</th></tr></thead><tbody><tr><td style=text-align:right><strong>description</strong></td><td style=text-align:left>Provides information about the user&rsquo;s SSH public key(s)</td></tr><tr><td style=text-align:right><strong>SAML Attribute(s)</strong></td><td style=text-align:left><code>urn:oid:1.3.6.1.4.1.24552.500.1.1.1.13</code> (sshPublicKey)</td></tr><tr><td style=text-align:right><strong>OIDC scope</strong></td><td style=text-align:left><code>ssh_public_key</code></td></tr><tr><td style=text-align:right><strong>OIDC claim(s)</strong></td><td style=text-align:left><code>ssh_public_key</code></td></tr><tr><td style=text-align:right><strong>OIDC claim location</strong></td><td style=text-align:left>UserInfo Endpoint</td></tr><tr><td style=text-align:right><strong>origin</strong></td><td style=text-align:left>Added SSH public key(s) in user&rsquo;s Check-in Profile</td></tr><tr><td style=text-align:right><strong>changes</strong></td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:right><strong>multiplicity</strong></td><td style=text-align:left>Multi-valued</td></tr><tr><td style=text-align:right><strong>availability</strong></td><td style=text-align:left>Not always</td></tr><tr><td style=text-align:right><strong>example</strong></td><td style=text-align:left><ul><li><code>ssh-rsa AAAAB3NzaC...qxxEEipdnZ jdoe@grnet-hq.admin.grnet.gr</code></li><li><code>ssh-rsa AAAA4xzdIf...fxgsRDfgAt jdoe@example.org</code></li></ul></td></tr><tr><td style=text-align:right><strong>notes</strong></td><td style=text-align:left>-</td></tr><tr><td style=text-align:right><strong>status</strong></td><td style=text-align:left>Experimental</td></tr></tbody></table><h3 id=16-orcid-id>16. ORCID iD</h3><table><thead><tr><th style=text-align:right>attribute name</th><th style=text-align:left>ORCID iD</th></tr></thead><tbody><tr><td style=text-align:right><strong>description</strong></td><td style=text-align:left>Provides information about the user&rsquo;s ORCID iD</td></tr><tr><td style=text-align:right><strong>SAML Attribute(s)</strong></td><td style=text-align:left><code>urn:oid:1.3.6.1.4.1.5923.1.1.1.16</code> (eduPersonOrcid)</td></tr><tr><td style=text-align:right><strong>OIDC scope</strong></td><td style=text-align:left><code>orcid</code></td></tr><tr><td style=text-align:right><strong>OIDC claim(s)</strong></td><td style=text-align:left><code>orcid</code></td></tr><tr><td style=text-align:right><strong>OIDC claim location</strong></td><td style=text-align:left>UserInfo Endpoint</td></tr><tr><td style=text-align:right><strong>origin</strong></td><td style=text-align:left>ORCID Identity Provider</td></tr><tr><td style=text-align:right><strong>changes</strong></td><td style=text-align:left>No</td></tr><tr><td style=text-align:right><strong>multiplicity</strong></td><td style=text-align:left>Single-valued</td></tr><tr><td style=text-align:right><strong>availability</strong></td><td style=text-align:left>Not always</td></tr><tr><td style=text-align:right><strong>example</strong></td><td style=text-align:left><code>https://orcid.org/XXXX-XXXX-XXXX-XXXX</code></td></tr><tr><td style=text-align:right><strong>notes</strong></td><td style=text-align:left>The attribute is available when logging in using ORCID</td></tr><tr><td style=text-align:right><strong>status</strong></td><td style=text-align:left>Experimental</td></tr></tbody></table><h3 id=17-subject-distinguished-name-dn-of-users-x509-certificate>17. Subject Distinguished Name (DN) of user&rsquo;s X.509 certificate</h3><table><thead><tr><th style=text-align:right>attribute name</th><th style=text-align:left>Subject Distinguished Name (DN) of user&rsquo;s X.509 certificate</th></tr></thead><tbody><tr><td style=text-align:right><strong>description</strong></td><td style=text-align:left>The Subject Distinguished Name of an X.509 certificate held by the person.</td></tr><tr><td style=text-align:right><strong>SAML Attribute(s)</strong></td><td style=text-align:left><code>1.3.6.1.4.1.25178.4.1.3</code> (voPersonCertificateDN)</td></tr><tr><td style=text-align:right><strong>OIDC scope</strong></td><td style=text-align:left><ul><li><code>voperson_certificate</code></li><li><code>aarc</code></li></ul></td></tr><tr><td style=text-align:right><strong>OIDC claim(s)</strong></td><td style=text-align:left><code>voperson_certificate_dn</code></td></tr><tr><td style=text-align:right><strong>OIDC claim location</strong></td><td style=text-align:left>UserInfo Endpoint</td></tr><tr><td style=text-align:right><strong>origin</strong></td><td style=text-align:left>Check-in or the user&rsquo;s Identity Provider</td></tr><tr><td style=text-align:right><strong>changes</strong></td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:right><strong>multiplicity</strong></td><td style=text-align:left>Multi-valued</td></tr><tr><td style=text-align:right><strong>availability</strong></td><td style=text-align:left>Not always</td></tr><tr><td style=text-align:right><strong>example</strong></td><td style=text-align:left><code>/C=XX/O=YYY/OU=ZZZ/CN=John Doe</code></td></tr><tr><td style=text-align:right><strong>notes</strong></td><td style=text-align:left>-</td></tr><tr><td style=text-align:right><strong>status</strong></td><td style=text-align:left>Experimental</td></tr></tbody></table><h3 id=18-issuer-distinguished-name-dn-of-users-x509-certificate>18. Issuer Distinguished Name (DN) of user&rsquo;s X.509 certificate</h3><table><thead><tr><th style=text-align:right>attribute name</th><th style=text-align:left>Issuer Distinguished Name (DN) of user&rsquo;s X.509 certificate</th></tr></thead><tbody><tr><td style=text-align:right><strong>description</strong></td><td style=text-align:left>The Subject Distinguished Name of the X.509 certificate issuer</td></tr><tr><td style=text-align:right><strong>SAML Attribute(s)</strong></td><td style=text-align:left><code>1.3.6.1.4.1.25178.4.1.4</code> (voPersonCertificateIssuerDN)</td></tr><tr><td style=text-align:right><strong>OIDC scope</strong></td><td style=text-align:left><ul><li><code>voperson_certificate</code></li><li><code>aarc</code></li></ul></td></tr><tr><td style=text-align:right><strong>OIDC claim(s)</strong></td><td style=text-align:left><code>voperson_certificate_issuer_dn</code></td></tr><tr><td style=text-align:right><strong>OIDC claim location</strong></td><td style=text-align:left>UserInfo Endpoint</td></tr><tr><td style=text-align:right><strong>origin</strong></td><td style=text-align:left>Check-in or the user&rsquo;s Identity Provider</td></tr><tr><td style=text-align:right><strong>changes</strong></td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:right><strong>multiplicity</strong></td><td style=text-align:left>Multi-valued</td></tr><tr><td style=text-align:right><strong>availability</strong></td><td style=text-align:left>Not always</td></tr><tr><td style=text-align:right><strong>example</strong></td><td style=text-align:left><code>/C=XX/O=YYY/OU=ZZZ/CN=Example CA</code></td></tr><tr><td style=text-align:right><strong>notes</strong></td><td style=text-align:left>-</td></tr><tr><td style=text-align:right><strong>status</strong></td><td style=text-align:left>Experimental</td></tr></tbody></table><h2 id=user-authorisation>User authorisation</h2><p>The following information about the authenticated user can be provided by EGI
Check-in in order to control user access to resources:</p><ol><li>VO/group membership and role information about the authenticated user</li><li>Capabilities</li><li>Identity Assurance</li><li>GOCDB roles</li></ol><h3 id=vogroup-membership-and-role-information>VO/group membership and role information</h3><h4 id=background>Background</h4><p>VO/group membership and role information is encoded in entitlements
(<code>eduPersonEntitlement</code> attribute values in SAML or <code>eduperson_entitlement</code>
claim in OIDC). These entitlements are typically used to indicate access rights
to protected resources. Entitlements are multi-valued, with each value formatted
as a URN.</p><h4 id=syntax>Syntax</h4><p>An entitlement value expressing group membership and role information has the
following syntax (components enclosed in square brackets are OPTIONAL):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>urn:mace:egi.eu:group:&lt;GROUP&gt;[:&lt;SUBGROUP&gt;*][:role=&lt;ROLE&gt;]#&lt;GROUP-AUTHORITY&gt;
</span></span></code></pre></div><p>where:</p><ul><li><code>&lt;GROUP></code> is the name of a VO, research collaboration or a top level arbitrary
group. <code>&lt;GROUP></code> names are unique within the <code>urn:mace:egi.eu:group</code>
namespace;</li><li>zero or more <code>&lt;SUBGROUP></code> components represent the hierarchy of subgroups in
the <code>&lt;GROUP></code>; specifying sub-groups is optional</li><li>the optional <code>&lt;ROLE></code> component is scoped to the rightmost (sub)group; if no
group information is specified, the role applies to the VO</li><li><code>&lt;GROUP-AUTHORITY></code> is a non-empty string that indicates the authoritative
source for the entitlement value. For example, it can be the FQDN of the group
management system that is responsible for the identified group membership
information</li></ul><p><strong>Example:</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>urn:mace:egi.eu:group:fedcloud.egi.eu:role=vm_operator#aai.egi.eu
</span></span></code></pre></div><h3 id=capabilities>Capabilities</h3><h4 id=background-1>Background</h4><p>The user&rsquo;s capability information is encoded in entitlements
(<code>eduPersonEntitlement</code> attribute values in SAML or <code>eduperson_entitlement</code>
claim in OIDC). These entitlements are typically used to indicate access rights
to protected resources. Entitlements are multi-valued, with each value formatted
as a URN following the syntax defined in
<a href=https://aarc-community.org/guidelines/aarc-g027/>AARC-G027</a>.</p><h4 id=syntax-1>Syntax</h4><p>An entitlement value expressing a capability has the following syntax
(components enclosed in square brackets are OPTIONAL):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>&lt;NAMESPACE&gt;:res:&lt;RESOURCE&gt;[:&lt;CHILD-RESOURCE&gt;]...[:act:&lt;ACTION&gt;[,&lt;ACTION&gt;]...]#&lt;AUTHORITY&gt;
</span></span></code></pre></div><p>where:</p><ul><li><p><code>&lt;NAMESPACE></code> is controlled by the e-infrastructure, research infrastructure
or research collaboration that manages the capability. The <code>&lt;NAMESPACE></code> of
capabilities managed by Check-in is set to <code>urn:mace:egi.eu</code>, while,
generally, it is in the form of
<code>urn:&lt;NID>:&lt;DELEGATED-NAMESPACE>[:&lt;SUBNAMESPACE>]...</code> where:</p><ul><li><p><code>&lt;NID></code> is the namespace identifier associated with a URN namespace
registered with IANA2, ensuring global uniqueness. Implementers SHOULD use
one of the existing registered URN namespaces, such as
<code>urn:mace</code>[<a href=https://incommon.org/community/mace-registries/mace-urn-registry/>MACE</a>].</p></li><li><p><code>&lt;DELEGATED-NAMESPACE></code> is a URN sub-namespace delegated from one of the
IANA registered NIDs to an organisation representing the e-infrastructure,
research infrastructure or research collaboration. It is RECOMMENDED that a
publicly accessible URN value registry for each delegated namespace be
provided.</p></li></ul></li><li><p>The literal string <code>"res"</code> indicates that this is a resource-specific
entitlement as opposed to, for example, an entitlement used for expressing
group membership
<a href=https://aarc-community.org/guidelines/aarc-g002/>AARC-G002</a>.</p></li><li><p><code>&lt;RESOURCE></code> is the name of the resource. Whether the name should be unique is
an implementation decision.</p></li><li><p>An optional list of colon-separated <code>&lt;CHILD-RESOURCE></code> components represents a
specific branch of the hierarchy of resources under the identified
<code>&lt;RESOURCE></code>.</p></li><li><p>An optional list of comma-separated <code>&lt;ACTION></code>s MAY be included, which, if
present, MUST be prefixed with the literal string “act”. This component MAY be
used for further specifying the actions a user is entitled to do at a given
resource. Note that the list of <code>&lt;ACTION></code>s is scoped to the rightmost
child-resource; if no child-resource information is specified, actions apply
to the top level resource. The interpretation of a capability without actions
specified is an implementation detail.</p></li><li><p><code>&lt;AUTHORITY></code> is a mandatory and non-empty string that indicates the
authoritative source of the capability. This SHOULD be used to further specify
the exact issuing instance. For example, it MAY be the FQDN of the service
that issued that specific capability. The <code>&lt;AUTHORITY></code> is specified in the
f-component <a href=https://tools.ietf.org/html/rfc8141>RFC8141</a> of the URN; thus,
it is introduced by the number sign ("#") character and terminated by the end
of the URN. All characters must be encoded according to
<a href=https://tools.ietf.org/html/rfc8141>RFC8141</a>. Hence, the <code>&lt;AUTHORITY></code> MUST
NOT be considered when determining equivalence (Section 3 in
<a href=https://tools.ietf.org/html/rfc8141>RFC8141</a>) of URN-formatted capabilities.
The <code>&lt;AUTHORITY></code> of capabilities managed by Check-in is typically set to
<code>aai.egi.eu</code>.</p></li></ul><p><strong>Example:</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>urn:mace:egi.eu:res:rcauth#aai.egi.eu
</span></span></code></pre></div><h3 id=identity-assurance>Identity Assurance</h3><p>Based on the authentication method selected by the user, the EGI proxy assigns a
Identity Assurance, which is conveyed to the SP through both the
<code>eduPersonAssurance</code> attribute and the Authentication Context Class
(<code>AuthnContextClassRef</code>) of the SAML authentication response. EGI Check-in uses
Assurance Profiles which distinguish between three Identity Assurance levels,
similarly to the
<a href="https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=OJ:JOL_2015_235_R_0002">eID Assurance Framework (eIDAF)</a>.
Each level is represented by a URI as follows:</p><ul><li><strong>Low</strong>: Authentication through a social identity provider or other low
identity assurance provider: <code>https://aai.egi.eu/LoA#Low</code></li><li><strong>Substantial</strong>: Password/X.509 authentication at the user's home IdP:
<code>https://aai.egi.eu/LoA#Substantial</code></li><li><strong>High</strong>: Substantial + multi-factor authn (not yet supported, TBD):
<code>https://aai.egi.eu/LoA#High</code></li></ul><p>Moreover, EGI Check-in follows the
<a href=https://wiki.refeds.org/display/ASS/REFEDS+Assurance+Framework+ver+1.0>REFEDS Assurance framework (RAF)</a>.
The EGI Check-in conveys any RAF values provided by the IdP directly to the SP,
through the aforementioned methods. Furthermore, Check-in will append into the
User&rsquo;s profile any additional LoA, if the user is eligible for it. For example,
a user having a Verified Email is eligible for the RAF value
<code>https://refeds.org/assurance/IAP/low</code></p><p>Some EGI SPs have been configured to provide limited access (or not to accept at
all) credentials with the Low LoA.</p><p>Note: When logging in through the EGI SSO IdP, the LoA is determined based on
the selected authentication mechanism as follows:</p><ul><li>Username/password credentials → Low</li><li>X.509 certification → Substantial</li></ul><h3 id=gocdb-roles>GOCDB Roles</h3><h4 id=background-2>Background</h4><p>GOCDB roles, as per
<a href=https://wiki.egi.eu/wiki/GOCDB/PI/get_user_method>GOCDB documentations</a>, are
encoded (<code>eduPersonEntitlement</code> attribute values in SAML or
<code>eduperson_entitlement</code> claim in OIDC). These entitlements are typically used to
indicate access rights to protected resources. Entitlements are multi-valued,
with each value formatted as a URN.</p><h4 id=syntax-2>Syntax</h4><p>An entitlement value expressing GOCDB roles has the following syntax (components
enclosed in square brackets are OPTIONAL):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>urn:mace:egi.eu:goc.egi.eu:&lt;PRIMARY_KEY&gt;:&lt;ON_ENTITY&gt;:&lt;USER_ROLE&gt;@egi.eu
</span></span></code></pre></div><p>where:</p><ul><li><code>&lt;PRIMARY_KEY></code> is the primary key for the user role, e.g. &ldquo;123G0&rdquo;</li><li><code>&lt;ON_ENTITY></code> is the name of the entity on which the user role applies to,
e.g. &ldquo;GRIDOPS-GOCDB&rdquo;</li><li><code>&lt;USER_ROLE></code> is the user&rsquo;s role, e.g. &ldquo;Site Operations Manager&rdquo;</li></ul><p><strong>Example:</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>urn:mace:egi.eu:goc.egi.eu:100453G0:GRIDOPS-CheckIn:Site+Administrator@egi.eu
</span></span></code></pre></div><div class=section-index></div><div class="text-muted mt-5 pt-3 border-top">Last modified
October 12, 2023
by
<a href=mailto:nliam@grnet.gr>Nicolas Liampotis</a>
: <a href=https://github.com/EGI-Federation/documentation/commit/e749a5fd0c5fc51fc843d444ecd8856c084a39f1>Check in docs/update providers (#614)</a></div></div></main></div></div><footer class="bg-dark py-3 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item footer-usr-link mx-2 h3" data-toggle=tooltip data-placement=top title="Community discussions" aria-label="Community discussions"><a class=text-white target=_blank rel=noopener href=https://community.egi.eu aria-label="Community discussions"><i class="fa fa-comments"></i></a></li><li class="list-inline-item footer-usr-link mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://twitter.com/EGI_eInfra aria-label=Twitter><i class="fab fa-twitter"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item github mx-0"><a class=github-button href=https://github.com/EGI-Federation/documentation data-icon=octicon-star data-show-count=true aria-label="Star EGI documentation on GitHub">Stars</a></li><li class="list-inline-item github mx-0"><a class=github-button href=https://github.com/EGI-Federation/documentation/fork data-icon=octicon-repo-forked data-show-count=true aria-label="Fork EGI documentation on GitHub">Forks</a></li><li class="list-inline-item footer-dev-link mx-2 h3" style=vertical-align:top data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/EGI-Federation aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 EGI Foundation. All rights reserved.</small><br><small class=ml-1><a href=https://www.egi.eu/privacy-policy/ target=_blank rel=noopener>Privacy Policy</a></small><br><small><a href=../../../about/>About EGI Documentation</a></small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/mermaid@8.9.2/dist/mermaid.min.js integrity=sha384-uQikAXnCAqsMb3ygtdqBYvcwvHUkzGIpjdGyy9owhURXHUxLC5LgTcSxJQH/RzjK crossorigin=anonymous></script>
<script src=../../../js/deflate.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/katex.min.css integrity=sha384-Cqd8ihRLum0CCg8rz0hYKPoLZ3uw+gES2rXQXycqnL5pgVQIflxAUDS7ZSjITLb5 crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/katex.min.js integrity=sha384-1Or6BdeNQb0ezrmtGeqQHFpppNd7a/gw29xeiSikBbsb44xu3uAo8c7FwbF5jhbd crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/contrib/mhchem.min.js integrity=sha384-LIgAiYlGSAdpNC9+YDjDPF6JeS/RRIumtNo0CmyQERZ/+g0h9MbuYQwf/5pQ4Y4M crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous onload=renderMathInElement(document.body,null)></script>
<script src=../../../js/main.min.d0b5594a58881d76643839c90ace353d66139058f0ee49bd0e7077fae617cb89.js integrity="sha256-0LVZSliIHXZkODnJCs41PWYTkFjw7km9DnB3+uYXy4k=" crossorigin=anonymous></script>
<script src=../../../js/prism.js></script></body></html>